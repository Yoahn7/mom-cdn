var Mom=window.Mom||function(){function getShortDate(){return getLocalDate().replace("年","-").replace("月","-").replace("日","")}function getLocalDate(){var e=new Date,t=e.getFullYear();t<1900&&(t+=1900);var n=e.getMonth()+1;n<10&&(n="0"+n);var r=e.getDate();return r<10&&(r="0"+r),t+"年"+n+"月"+r+"日"}function getLocalTime(){var e=new Date,t=e.getHours();t<10&&(t="0"+t);var n=e.getMinutes();n<10&&(n="0"+n);var r=e.getSeconds();return r<10&&(r="0"+r),t+":"+n+":"+r}function getLocalWeek(){var e=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],t=new Date,n=e[t.getDay()];return n}function showMsg(e,t,n,r){if(n||(n="body"),$(n).length){var a="";r||(t.indexOf("失败")>-1||t.indexOf("异常")>-1||t.indexOf("错误")>-1?(r="danger",a="<strong>失败!</strong> "):r="info",t.indexOf("成功")>-1&&(a="<strong>成功!</strong> ")),e&&$(n).children(".alert-dismissible").remove(),0==$(n).children(".alert-"+r).length&&$(n).prepend("<div class='alert alert-"+r+" alert-dismissible fade show'><button type='button' class='close' data-dismiss='alert'>&times;</button>"+a+"<span class='alert-content'></span></div>");var o=$(n).children(".alert-"+r).children(".alert-content").html();o&&(o+="<br/>"),$(n).children(".alert-"+r).children(".alert-content").html(o+t)}}function notify(e,t,n,r){null!=t&&""!=t||(t=e.indexOf("失败")>-1||e.indexOf("异常")>-1||e.indexOf("错误")>-1?"error":"success"),null!=n&&""!=n||(n="系统提示:");var a=top();if(a.toastr){a.toastr.options=$.extend(!0,{},{closeButton:!0,debug:!1,progressBar:!0,preventDuplicates:!1,positionClass:"toast-top-right mgt-58",onclick:null,showDuration:"400",hideDuration:"1000",timeOut:"7000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},r);var o=a.toastr[t](e,n);o.find("#okBtn").length&&o.delegate("#okBtn","click",function(){o.remove()}),o.find("#surpriseBtn").length&&o.delegate("#surpriseBtn","click",function(){})}else layAlert(e)}function createTagFrame(e,t,n){n=(n||t).replaceAll("\\.","\\.");for(var r=document.getElementById(e),a=r.getElementsByTagName("iframe"),o=document.getElementById(n),i=0;i<a.length;i++)a[i].id!=t&&(a[i].style.display="none");return null!=o&&null!=o||(o=document.createElement("iframe"),o.id=n,o.style.height="100%",o.style.width="100%",o.marginWidth="0",o.frameBorder="0",o.frameSpacing="0",o.scrolling="no",o.style.overflow="hidden",r.appendChild(o)),null!=t&&""!=t&&""==o.src&&(o.src=t),o.style.display="inline",r}function setFrameHeight(e,t){for(var n=window.parent.document.getElementsByTagName("iframe"),r=0;r<n.length;r++){var a=n[r];if(null!=a&&"none"!=a.style.display){var o=document.body.scrollHeight+(e||0),i=20;$(a).css("height").replace("px","")<o&&(t?t(a,o+i):a.style.height=o+i+"px")}}}var top=function(){function e(e){return e.location.protocol+"//"+e.location.host}var t=window,n=e(t);try{for(;t.parent&&t.location!=t.parent.location&&n==e(t.parent);)t=t.parent}catch(e){}return t},basePath=function(){var e=window.location,t=(e.pathname.split("/")[1],e.protocol+"//"+e.host);return t},refresh=function(){location.href=location.href},idStr=function(){return Number(Math.random().toString().substr(3,length)+Date.now()).toString(36)},resolveUrl=function(url){if(url.indexOf("${token}")>-1){var tokenKey=getUrlParam("tokenKey",url);if(tokenKey){var thirdToken=sessionStorage.getItem("thirdToken_"+tokenKey+"_"+getAuthInfo("loginName"));if(!thirdToken){var apiCfg={url:Const.admin+"/api/oauth/token3rd/"+tokenKey,data:{},async:!1};Api.ajaxAdvance(apiCfg,function(e){if(!e.success)return Mom.layMsg(e.message),url;thirdToken=e.AccessToken3rd,sessionStorage.setItem("thirdToken_"+tokenKey+"_"+getAuthInfo("loginName"),thirdToken)})}url=url.replace("${token}",thirdToken)}else url=url.replace("${token}",getAuthInfo("authorization"));url=url.replace("${tokenType}",getAuthInfo("tokenType"))}if(url.indexOf("${userId}")>-1){var loginUserid=getAuthInfo("loginUserid");url=url.replace("${userId}",loginUserid)}if(url.indexOf("${loginName}")>-1){var loginName=getAuthInfo("loginName");url=url.replace("${loginName}",loginName)}for(var reg=/\$\{((\w|\.)+)}/g,rr=[];rr=reg.exec(url);)try{url=url.replace(rr[0],eval(rr[1]))}catch(e){console.error(e)}return url},extractUrl=function(e,t){if(!t||!e)return e;var n="";if("string"==typeof t)0==t.indexOf("?")&&(t=t.substr(1)),0!=t.indexOf("&")&&(t="&"+t),n=t;else if("[object Array]"===Object.prototype.toString.call(t))for(var r="string"==typeof t?[t]:t,a=0;a<r.length;a++)n+="&"+r[a];else for(var o in t){var i=t[o];n+="&"+o+"="+i}return 0<n.length&&(n=(e.indexOf("?")<0?"?":"&")+encodeURI(n.substr(1))),e+n},getUrlParam=function(e,t){var n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i");return t=t&&""!=t?t.substring(t.indexOf("?")):window.location.search,r=t.substr(1).match(n),null!=r?decodeURIComponent(r[2]):null},localStorageSupport=function(){return"localStorage"in window&&null!==window.localStorage},getFileExt=function(e){return e?e.substring(e.lastIndexOf(".")+1,e.length).toLowerCase():""},getOpener=function(){var e=window.dialogArguments;return null!=e?e:window.parent},winBack=function(e){if(null!=e&&null!=e)location.href=e;else{var t=getOpener();null==t.opener?history.go(-1):t.close()}},postcall=function(e,t,n){var r=document.createElement("form");for(var a in r.action=e,r.method="post",r.style.display="none",n&&(r.target=n),t){var o=document.createElement("input");o.name=a,o.value=t[a],r.appendChild(o)}document.body.appendChild(r),r.submit(),document.body.removeChild(r)},BrowserType=function(e){var t=navigator.userAgent,n=t.indexOf("Opera")>-1,r=t.indexOf("compatible")>-1&&t.indexOf("MSIE")>-1&&!n,a=t.indexOf("Trident/7.0;")>-1&&t.indexOf("Windows NT 6.1")>-1&&!r,o=t.indexOf("Firefox")>-1,i=t.indexOf("Safari")>-1&&-1==t.indexOf("Chrome"),l=t.indexOf("Chrome")>-1&&t.indexOf("Safari")>-1,s=t.toLowerCase().indexOf("trident")>-1&&t.indexOf("rv")>-1;if(r&&e){var u=new RegExp("MSIE (\\d+\\.\\d+);");u.test(t);var c=parseFloat(RegExp.$1);return e==c}return s?"ie11":o?"FF":n?"Opera":i?"Safari":l?"Chrome":a?"Edge":void 0},isMobileAgent=function(){var e=navigator.userAgent.toLowerCase(),t="ipad"==e.match(/ipad/i),n="iphone os"==e.match(/iphone os/i),r="midp"==e.match(/midp/i),a="rv:1.2.3.4"==e.match(/rv:1.2.3.4/i),o="ucweb"==e.match(/ucweb/i),i="android"==e.match(/android/i),l="windows ce"==e.match(/windows ce/i),s="windows mobile"==e.match(/windows mobile/i);return!!(t||n||r||a||o||i||l||s)},AddFavorite=function(e,t){e=null!=e?e:window.location,t=null!=t?t:document.title;try{document.all?window.external.addFavorite(e,t):window.sidebar&&window.sidebar.addPanel(t,e,"")}catch(e){window.alert("加入收藏失败，请使用Ctrl+D进行添加!")}},launchFullscreen=function(e){e=e||document.documentElement,$("body").hasClass("full-screen")?($("body").removeClass("full-screen"),document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()):($("body").addClass("full-screen"),e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen())},getInfoByCardId=function(e){var t={},n="",r="",a=0;if(null!=e&&e.length>14){e=e.trim();var o=e[e.length-2];if(r=o%2!=0?"男":"女",15==e.length?(n=e.substring(6,12),n="19"+n,n=n.substring(0,4)+"-"+n.substring(4,6)+"-"+n.substring(6)):e.length>15&&(n=e.substring(6,14),n=n.substring(0,4)+"-"+n.substring(4,6)+"-"+n.substring(6)),n.length>3){var i=(new Date).getYear();i<1900&&(i+=1900),a=i-n.substring(0,4)}}return t.sex=r,t.birthday=n,t.age=a,t},clearForm=function(e,t){null!=e&&null!=e||(e=document.forms[0]);var n=e.elements;n||(n=$(e).find("input,textarea,select"));for(var r=0,a=n.length;r<a;r++)if("hidden"==n[r].type)1==t&&(n[r].value="");else if("text"==n[r].type||"textarea"==n[r].type||"number"==n[r].type)n[r].value="";else if("select-one"==n[r].type||"select-multiple"==n[r].type)if(n[r].className.indexOf("select2")>-1)try{var o=$(n[r]).attr("data-width")||"100%",i=$(n[r]).attr("data-height")||"200px",l=$(n[r]).attr("data-allowClear")||"true",s={language:"zh-CN",placeholder:"请选择",allowClear:"true"==l,minimumResultsForSearch:15,width:o,height:i};$(n[r]).hasClass("multiple")&&(s.allowClear="true"==l,s.multiple=!0,s.closeOnSelect=!1),$(n[r]).select2(s).val("").trigger("change")}catch(e){}else{n[r].value="";try{$(n[r]).trigger("change")}catch(e){console.error(e)}}else"checkbox"==n[r].type&&n[r].checked&&($(n[r]).hasClass("i-checks")?$(n[r]).iCheck("unCheck"):$(n[r]).attr("checked",!1))},dateCompare=function(e,t){if(e&&t){var n=0,r=0;return"string"==typeof e?e.indexOf("-")<0&&e.indexOf(":")>-1?n=Number(e.replace(/:/g,"")):(e=new Date(e.replace(/-/g,"/")),n=e.getTime()):n=e.getTime(),"string"==typeof t?t.indexOf("-")<0&&t.indexOf(":")>-1?r=Number(t.replace(/:/g,"")):(t=new Date(t.replace(/-/g,"/")),r=t.getTime()):r=t.getTime(),n-r}return 0},isDateCross=function(e,t,n,r){return"string"==typeof e&&(e=new Date(e.replace(/-/g,"/"))),"string"==typeof t&&(t=new Date(t.replace(/-/g,"/"))),"string"==typeof n&&(n=new Date(n.replace(/-/g,"/"))),"string"==typeof r&&(r=new Date(r.replace(/-/g,"/"))),e<=n&&t>=n||e>=n&&e<=r},dateAddDay=function(e,t){"string"==typeof e&&(e=new Date(e.replace(/-/g,"/")));var n,r,a=e,o=new Date(new Date(a).valueOf()+24*t*60*60*1e3);return n=o.getMonth()+1<10?"0"+(o.getMonth()+1):o.getMonth()+1,r=o.getDate()<10?"0"+o.getDate():o.getDate(),o.getFullYear()+"-"+n+"-"+r},timeStampAddSub=function(e,t){e.indexOf(" ")<0&&(e=getShortDate()+" "+e);var n=e.substring(0,19);n=n.replace(/-/g,"/");var r=new Date(n),a=new Date(r.getTime()+1e3*Number(t)),o=new Date(a),i=o.getFullYear(),l=o.getMonth()+1,s=o.getDate(),u=o.getHours(),c=o.getMinutes(),d=o.getSeconds();return i+"-"+(l<10?"0"+l:l)+"-"+(s<10?"0"+s:s)+" "+(u<10?"0"+u:u)+":"+(c<10?"0"+c:c)+":"+(d<10?"0"+d:d)},isLastDay=function(e){var t=e||getShortDate();"string"==typeof t&&(t=new Date(t.replace(/\-/g,"/")));var n=new Date(new Date(t).valueOf()+864e5);return t.getMonth()!=n.getMonth()},dateAddYear=function(e,t){"string"==typeof e&&(e=new Date(e.replace(/-/g,"/")));var n=e,r=new Date(n.getFullYear()+t,n.getMonth(),n.getDate());return r},addEvent=function(e,t,n){if(e.addEventListener)return e.addEventListener(t,n,!1),!0;if(e.attachEvent){var r=e.attachEvent("on"+t,n);return r}return!1},json2str=function(e){var t=[],n=function(e){return"object"==typeof e&&null!=e?json2str(e):/^(string|number)$/.test(typeof e)?"'"+e+"'":e};for(var r in e)t.push("'"+r+"':"+n(e[r]));return"{"+t.join(",")+"}"},serializeJSON_KEY=function(e){function t(e){for(var t=Object.getOwnPropertyNames(e),r=0;r<t.length;r++){var a=t[r];if(""!=a){var o=e[a],i=a.split("."),l=i.length,s=n;$.each(i,function(e,t){e==l-1?s[t]?(s[t].push||(s[t]=[s[t]]),s[t].push(o||"")):s[t]=o||"":s[t]||(s[t]={}),s=s[t]})}}return n}var n={},r=[],a=null,o="[object Array]"===Object.prototype.toString.call(e),i="[object Object]"===Object.prototype.toString.call(e);if(!e)return n;if(o&&e.length)$(e).each(function(e,o){a=o,n={},r.push(t(a))});else if(i)return a=e,t(a);return r},setCookie=function(e,t,n,r){null==n&&(n=2592e3);var a=new Date;a.setTime(a.getTime()+1e3*n);var o=null!=r?r:"/";document.cookie=e+"="+encodeURI(t)+";expires="+a.toGMTString()+";path="+o},getCookie=function(e){var t,n=new RegExp("(^| )"+e+"=([^;]*)(;|$)");if(t=document.cookie.match(n)){var r=decodeURI(t[2]);return"undefined"==r&&(r=""),r}return""},delCookie=function(e,t){var n=new Date;n.setTime(n.getTime()-1);var r=getCookie(e);if(null!=r){var a=null!=t?t:"/";document.cookie=e+"="+r+";expires="+n.toGMTString()+";path="+a}},include=function(e,t,n){if(t.lastIndexOf("/")!=t.length-1&&(t+="/"),null==document.getElementById(e))for(var r="string"==typeof n?[n]:n,a=0;a<r.length;a++){var o,i=r[a].replace(/^\s|\s$/g,""),l=getFileExt(r[a]).toLowerCase(),s=extractUrl(t+i,"r="+(new Date).getTime());"css"==l?(o=document.createElement("link"),o.setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href",s)):(o=document.createElement("script"),o.setAttribute("type","text/javascript"),o.setAttribute("src",s)),o&&(o.setAttribute("id",e),$(o).insertBefore("title"))}},layLoading=function(e){return e?layer.msg(e,{icon:16,shade:.01,shadeClose:!1,time:-1,skin:"loading-text"}):layer.load(2)},layMsg=function(e,t,n){var r={time:t||1800,shade:.01};n&&(r.icon=n);var a=top();return a.layer.msg(e,r)},layAlert=function(e,t,n,r){t=t||0;var a=0==t?"警告":"消息",o=top(),i=$.extend(!0,{},{skin:Const.layerSkin()||"",icon:t,title:a},r),l=o.layer.alert(e,i,function(e){n&&n(e),o.layer.close(e)});return l},layConfirm=function(e,t,n){var r=top();r.layer.confirm(e,{skin:Const.layerSkin()||"",icon:3,title:"系统提示"},function(e,n){r.layer.close(e),t&&t(e,n)},function(e){r.layer.close(e),n&&n(e)})},jsGetVal=function(e){for(var t="",n="",r=e.split("."),a=0;a<r.length;a++)n+="."+r[a],t+="!"+n.substring(1)+"?'':";return t+=n.substring(1),t},countDownSecond=function(e,t){var n=setInterval(function(){e>0?(--e,t(e)):clearInterval(n)},1e3);return n},countDownDate=function(e,t){var n=(new Date(e)-new Date)/1e3,r=setInterval(function(){if(n>0){var e=parseInt(n/60/60/24,10),a=parseInt(n/60/60%24,10),o=parseInt(n/60%60,10),i=parseInt(n%60,10);a=a<10?"0"+a:a,o=o<10?"0"+o:o,i=i<10?"0"+i:i,t(e,a,o,i),--n}else clearInterval(r),t(0,0,0,0)},1e3);return r},getAuthInfo=function(e){if(e){var t,n=sessionStorage.getItem("userInfo")||getCookie("userInfo"),r=JSON.parse(""==n?"{}":n);return t=r[e]||"",""==t&&(t=sessionStorage.getItem(e)||"",""==t&&(t=getCookie(e)||"")),t}var a=sessionStorage.getItem("tokenType")||"";""==a&&(a=getCookie("tokenType"));var o=sessionStorage.getItem("authorization")||"";return""==o&&(o=getCookie("authorization")),$.trim(a+" "+o)},localize=function(e){var t=document.getElementById("lang");t&&t.parentNode.removeChild(t);var n=getCookie("somoveLanguage")||"";null!=n&&""!=n||(n=navigator.language||navigator.browserLanguage),n=n.toLowerCase(),window.include([{id:"lang",url:"/i18n/lang/js/"+n+".js"}],function(){e&&e()})};return{top:top,getTop:top,basePath:basePath(),refresh:refresh,idStr:idStr,resolveUrl:resolveUrl,extractUrl:extractUrl,getUrlParam:getUrlParam,isMobileAgent:isMobileAgent(),BrowserType:BrowserType,localStorageSupport:localStorageSupport(),getFileExt:getFileExt,getOpener:getOpener,winBack:winBack,postcall:postcall,AddFavorite:AddFavorite,launchFullscreen:launchFullscreen,getInfoByCardId:getInfoByCardId,clearForm:clearForm,shortDate:getShortDate(),localDate:getLocalDate(),localTime:getLocalTime,localWeek:getLocalWeek,dateCompare:dateCompare,isDateCross:isDateCross,dateAddDay:dateAddDay,timeStampAddSub:timeStampAddSub,isLastDay:isLastDay,dateAddYear:dateAddYear,addEvent:addEvent,json2str:json2str,serializeJSON_KEY:serializeJSON_KEY,setCookie:setCookie,getCookie:getCookie,delCookie:delCookie,include:include,showMsg:showMsg,notify:notify,layLoading:layLoading,layMsg:layMsg,layAlert:layAlert,layConfirm:layConfirm,jsGetVal:jsGetVal,countDownSecond:countDownSecond,countDownDate:countDownDate,createTagFrame:createTagFrame,setFrameHeight:setFrameHeight,getAuthInfo:getAuthInfo,localize:localize}}();