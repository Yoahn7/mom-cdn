(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof module==="object"&&module.exports){module.exports=a(require("jquery"))}else{a(window.jQuery)}}}(function(c){var b=c.summernote.ui;var d=c.summernote.dom;var a=function(g){var e=this;var f=g.options;var h=f.langInfo;e.icon='<i class="fa fa-object-group"/>';g.memo("button.databasic",function(){return b.button({contents:e.icon,tooltip:h.databasic.insert,click:g.createInvokeHandler("databasic.showDialog")}).render()});g.memo("button.databasicDialog",function(){return b.button({contents:e.icon,tooltip:h.databasic.edit,click:g.createInvokeHandler("databasic.showDialog")}).render()});g.memo("button.databasicSize100",function(){return b.button({contents:'<span class="note-fontsize-10">100%</span>',tooltip:h.image.resizeFull,click:g.createInvokeHandler("editor.resize","1")}).render()});g.memo("button.databasicSize50",function(){return b.button({contents:'<span class="note-fontsize-10">50%</span>',tooltip:h.image.resizeHalf,click:g.createInvokeHandler("editor.resize","0.5")}).render()});g.memo("button.databasicSize25",function(){return b.button({contents:'<span class="note-fontsize-10">25%</span>',tooltip:h.image.resizeQuarter,click:g.createInvokeHandler("editor.resize","0.25")}).render()});e.events={"summernote.init":function(i,j){c("data.ext-databasic",j.editable).each(function(){e.setContent(c(this))})},"summernote.keyup summernote.mouseup summernote.change summernote.scroll":function(){e.update()},"summernote.dialog.shown":function(){e.hidePopover()}};e.initialize=function(){var k=f.dialogsInBody?c(document.body):g.layoutInfo.editor;var i='<div class="form-group row-fluid"><label>'+h.databasic.testLabel+'</label><input class="ext-databasic-test form-control" type="text" /></div>';var l='<button href="#" class="btn btn-primary ext-databasic-save">'+h.databasic.insert+"</button>";e.$dialog=b.dialog({title:h.databasic.name,fade:f.dialogsFade,body:i,footer:l}).render().appendTo(k);e.$popover=b.popover({className:"ext-databasic-popover"}).render().appendTo("body");var j=e.$popover.find(".popover-content");g.invoke("buttons.build",j,f.popover.databasic)};e.destroy=function(){e.$popover.remove();e.$popover=null;e.$dialog.remove();e.$dialog=null};e.update=function(){if(!g.invoke("editor.hasFocus")){e.hidePopover();return}var i=g.invoke("editor.createRange");var k=false;if(i.isOnData()){var j=c(i.sc).closest("data.ext-databasic");if(j.length){var l=d.posFromPlaceholder(j[0]);e.$popover.css({display:"block",left:l.left,top:l.top});g.invoke("editor.saveTarget",j[0]);k=true}}if(!k){e.hidePopover()}};e.hidePopover=function(){e.$popover.hide()};e.getInfo=function(){var i=g.invoke("editor.createRange");if(i.isOnData()){var j=c(i.sc).closest("data.ext-databasic");if(j.length){return{node:j,test:j.attr("data-test")}}}return{}};e.setContent=function(i){i.html('<p contenteditable="false">'+e.icon+" "+h.databasic.name+": "+i.attr("data-test")+"</p>")};e.updateNode=function(i){e.setContent(i.node.attr("data-test",i.test))};e.createNode=function(j){var i=c('<data class="ext-databasic"></data>');if(i){j.node=i;g.invoke("editor.insertNode",i[0])}return i};e.showDialog=function(){var j=e.getInfo();var i=!j.node;g.invoke("editor.saveRange");e.openDialog(j).then(function(k){b.hideDialog(e.$dialog);g.invoke("editor.restoreRange");if(i){e.createNode(j)}c.extend(j,k);e.updateNode(j)}).fail(function(){g.invoke("editor.restoreRange")})};e.openDialog=function(i){return c.Deferred(function(k){var m=e.$dialog.find(".ext-databasic-test");var l=e.$dialog.find(".ext-databasic-save");var j=function(n){if(n.keyCode===13){l.trigger("click")}};b.onDialogShown(e.$dialog,function(){g.triggerEvent("dialog.shown");m.val(i.test).on("input",function(){b.toggleBtn(l,m.val())}).trigger("focus").on("keyup",j);l.text(i.node?h.databasic.edit:h.databasic.insert).click(function(n){n.preventDefault();k.resolve({test:m.val()})});b.toggleBtn(l,m.val())});b.onDialogHidden(e.$dialog,function(){m.off("input keyup");l.off("click");if(k.state()==="pending"){k.reject()}});b.showDialog(e.$dialog)})}};c.extend(true,c.summernote,{plugins:{databasic:a},options:{popover:{databasic:[["databasic",["databasicDialog","databasicSize100","databasicSize50","databasicSize25"]]]}},lang:{"en-US":{databasic:{name:"Basic Data Container",insert:"insert basic data container",edit:"edit basic data container",testLabel:"test input"}}}})}));