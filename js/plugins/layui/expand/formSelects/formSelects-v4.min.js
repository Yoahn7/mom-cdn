"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol==="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}(function(a,c,b){if((typeof exports==="undefined"?"undefined":_typeof(exports))==="object"){module.exports=b()}else{if(typeof define==="function"&&define.amd){define(b)}else{if(c.layui&&a.define){a.define(["jquery"],function(d){d("formSelects",b())})}else{c.formSelects=b()}}}})(typeof layui=="undefined"?null:layui,window,function(){var S="4.0.0.0910",K="xm-select",Q="xm-select-parent",d="xm-select-input",V="xm-select--suffix",s="xm-select-this",Y="xm-select-label",z="xm-select-search",k="xm-select-search-type",f="xm-select-show-count",T="xm-select-create",o="xm-select-create-long",ab="xm-select-max",R="xm-select-skin",D="xm-select-direction",I="xm-select-height",G="xm-dis-disabled",p="xm-select-dis",A="xm-select-temp",P="xm-select-radio",U="xm-select-linkage",b="xm-select-dl",w="xm-select-hide",O="xm-hide-input",g="xm-select-sj",a="xm-icon-close",B="xm-select-title",E="xm-form-select",r="xm-form-selected",M="xm-select-none",Z="xm-select-empty",ac="xm-input",F="xm-dl-input",u="xm-select-tips",q="xm-iconfont",h="XM_PID_VALUE",e="xm-cz",ad="xm-cz-group",c="请选择",aa={},y={on:{},endOn:{},filter:{},maxTips:{},opened:{},closed:{}},J={type:"get",header:{},first:true,data:{},searchUrl:"",searchName:"keyword",searchVal:null,keyName:"name",keyVal:"value",keySel:"selected",keyDis:"disabled",keyChildren:"children",dataType:"",delay:500,beforeSuccess:null,success:null,error:null,beforeSearch:null,response:{statusCode:0,statusName:"code",msgName:"msg",dataName:"data"},tree:{nextClick:function j(af,v,ae){ae([])},folderChoose:true,lazy:true}},X=[{icon:"xm-iconfont icon-quanxuan",name:"全选",click:function L(ae,v){v.selectAll(ae,true,true)}},{icon:"xm-iconfont icon-qingkong",name:"清空",click:function L(ae,v){v.removeAll(ae,true,true)}},{icon:"xm-iconfont icon-fanxuan",name:"反选",click:function L(ae,v){v.reverse(ae,true,true)}},{icon:"xm-iconfont icon-pifu",name:"换肤",click:function L(ae,v){v.skin(ae)}}],H=window.$||window.layui&&window.layui.jquery,C=H(window),m={},x={},N={},n=function n(v){var ai=this;this.config={name:null,max:null,maxTips:function ah(an,al,am,aj){var ak=H('[xid="'+ai.config.name+'"]').prev().find("."+K);if(ak.parents(".layui-form-item[pane]").length){ak=ak.parents(".layui-form-item[pane]")}ak.attr("style","border-color: red !important");setTimeout(function(){ak.removeAttr("style")},300)},init:null,on:null,opened:null,closed:null,filter:function ag(am,ak,al,aj){return al.name.indexOf(ak)==-1},clearid:-1,direction:"auto",height:null,isEmpty:false,btns:[X[0],X[1],X[2]],searchType:0,create:function ae(ak,aj){return Date.now()},template:function af(ak,aj){return aj.name},showCount:0,isCreate:false,placeholder:c,clearInput:false};this.select=null;this.values=[];H.extend(this.config,v,{searchUrl:v.isSearch?v.searchUrl:null,placeholder:v.optionsFirst?v.optionsFirst.value?c:v.optionsFirst.innerHTML||c:c,btns:v.radio?[X[1]]:[X[0],X[1],X[2]]},N[v.name]||x);if(isNaN(this.config.showCount)||this.config.showCount<=0){this.config.showCount=19921012}};var W=function W(){this.appender();this.on();this.onreset()};W.prototype.appender=function(){if(!Array.prototype.map){Array.prototype.map=function(ae,af){var al,am,ak,ai=Object(this),ah=ai.length>>>0;if(af){al=af}am=new Array(ah);ak=0;while(ak<ah){var aj,ag;if(ak in ai){aj=ai[ak];ag=ae.call(al,aj,ak,ai);am[ak]=ag}ak++}return am}}if(!Array.prototype.forEach){Array.prototype.forEach=function v(ag,ae){var aj,ak;if(this==null){throw new TypeError("this is null or not defined")}var ah=Object(this);var af=ah.length>>>0;if(typeof ag!=="function"){throw new TypeError(ag+" is not a function")}if(arguments.length>1){aj=ae}ak=0;while(ak<af){var ai;if(ak in ah){ai=ah[ak];ag.call(aj,ai,ak,ah)}ak++}}}if(!Array.prototype.filter){Array.prototype.filter=function(ae){if(this===void 0||this===null){throw new TypeError()}var ah=Object(this);var af=ah.length>>>0;if(typeof ae!=="function"){throw new TypeError()}var ai=[];var aj=arguments[1];for(var ak=0;ak<af;ak++){if(ak in ah){var ag=ah[ak];if(ae.call(aj,ag,ak,ah)){ai.push(ag)}}}return ai}}};W.prototype.init=function(ae){var v=this;H(ae?ae:"select["+K+"]").each(function(an,ap){var ah=H(ap),ag=ah.attr(K),aj=ah.next(".layui-form-select"),ai=ah.next("."+Q),at={name:ag,disabled:ap.disabled,max:ah.attr(ab)-0,isSearch:ah.attr(z)!=undefined,searchUrl:ah.attr(z),isCreate:ah.attr(T)!=undefined,radio:ah.attr(P)!=undefined,skin:ah.attr(R),direction:ah.attr(D),optionsFirst:ap.options[0],height:ah.attr(I),formname:ah.attr("name")||ah.attr("_name"),layverify:ah.attr("lay-verify")||ah.attr("_lay-verify"),layverType:ah.attr("lay-verType"),searchType:ah.attr(k)=="dl"?1:0,showCount:ah.attr(f)-0},aq=ah.find("option[selected]").toArray().map(function(au){return{name:au.innerHTML,value:au.value}}),am=new n(at);am.values=aq;if(am.config.init){am.values=am.config.init.map(function(au){if((typeof au==="undefined"?"undefined":_typeof(au))=="object"){return au}return{name:ah.find('option[value="'+au+'"]').text(),value:au}}).filter(function(au){return au.name});am.config.init=am.values.concat([])}else{am.config.init=aq.concat([])}!am.values&&(am.values=[]);aa[ag]=am;aj[0]&&aj.remove();ai[0]&&ai.remove();var al=v.renderSelect(ag,am.config.placeholder,ap);var af=!am.config.height||am.config.height=="auto"?"":'xm-hg style="height: 34px;"';var ar=['<div class="'+Y+'">','<input type="text" fsw class="'+ac+" "+d+'" '+(am.config.isSearch?"":'style="display: none;"')+' autocomplete="off" debounce="0" />',"</div>"];var ao=H('<div class="'+E+'" '+R+'="'+am.config.skin+'">\n\t\t\t\t\t<input class="'+O+'" value="" name="'+am.config.formname+'" lay-verify="'+am.config.layverify+'" lay-verType="'+am.config.layverType+'" type="text" style="position: absolute;bottom: 0; z-index: -1;width: 100%; height: 100%; border: none; opacity: 0;"/>\n\t\t\t\t\t<div class="'+B+" "+(am.config.disabled?p:"")+'">\n\t\t\t\t\t\t<div class="'+ac+" "+K+'" '+af+">\n\t\t\t\t\t\t\t"+ar.join("")+'\n\t\t\t\t\t\t\t<i class="'+g+'"></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="'+V+'">\n\t\t\t\t\t\t\t<input type="text" autocomplete="off" placeholder="'+am.config.placeholder+'" readonly="readonly" unselectable="on" class="'+ac+'">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<dl xid="'+ag+'" class="'+b+" "+(am.config.radio?P:"")+'">'+al+"</dl>\n\t\t\t\t</div>");var ak=H('<div class="'+Q+'" FS_ID="'+ag+'"></div>');ak.append(ao);ah.after(ak);ah.attr("lay-ignore","");ah.removeAttr("name")&&ah.attr("_name",am.config.formname);ah.removeAttr("lay-verify")&&ah.attr("_lay-verify",am.config.layverify);if(am.config.isSearch){m[ag]=H.extend({},J,{searchUrl:am.config.searchUrl},m[ag]);H(document).on("input","div."+Q+'[FS_ID="'+ag+'"] .'+d,function(au){v.search(ag,au,am.config.searchUrl)});if(am.config.searchUrl){v.triggerSearch(ao,true)}}else{ao.find("dl dd."+F).css("display","none")}})};W.prototype.search=function(ae,al,ai,aq){var aj=this;var an=void 0;if(aq){an=aq}else{an=al.target;var ap=al.keyCode;if(ap===9||ap===13||ap===37||ap===38||ap===39||ap===40){return false}}var af=H.trim(an.value);this.changePlaceHolder(H(an));var ao=m[ae]?m[ae]:J;ai=ao.searchUrl||ai;var ah=aa[ae],v=ah.config.isCreate,am=H('dl[xid="'+ae+'"]').parents("."+E);if(ai){if(ao.searchVal){af=ao.searchVal;ao.searchVal=""}if(!ao.beforeSearch||ao.beforeSearch&&ao.beforeSearch instanceof Function&&ao.beforeSearch(ae,ai,af)){var ag=ao.delay;if(ao.first){ao.first=false;ag=10}clearTimeout(ah.clearid);ah.clearid=setTimeout(function(){am.find("dl > *:not(."+u+")").remove();am.find("dd."+M).addClass(Z).text("请求中");aj.ajax(ae,ai,af,false,null,true)},ag)}}else{am.find("dl ."+w).removeClass(w);am.find("dl dd:not(."+u+")").each(function(ar,av){var at=H(av);var au=y.filter[ae]||aa[ae].config.filter;if(au&&au(ae,af,aj.getItem(ae,at),at.hasClass(G))==true){at.addClass(w)}});am.find("dl dt").each(function(ar,at){if(!H(at).nextUntil("dt",":not(."+w+")").length){H(at).addClass(w)}});this.create(ae,v,af);var ak=am.find("dl dd:not(."+u+"):not(."+w+")");if(!ak.length){am.find("dd."+M).addClass(Z).text("无匹配项")}else{am.find("dd."+M).removeClass(Z)}}};W.prototype.isArray=function(v){return Object.prototype.toString.call(v)=="[object Array]"};W.prototype.triggerSearch=function(af,ae){var v=this;(af?[af]:H("."+E).toArray()).forEach(function(ag,ah){ag=H(ag);var ai=ag.find("dl").attr("xid");if(ai&&aa[ai]&&aa[ai].config.isEmpty||ae){v.search(ai,null,null,aa[ai].config.searchType==0?ag.find("."+Y+" ."+d):ag.find("dl ."+F+" ."+d))}})};W.prototype.clearInput=function(af){var ae=H("."+Q+'[fs_id="'+af+'"]');var v=aa[af].config.searchType==0?ae.find("."+Y+" ."+d):ae.find("dl ."+F+" ."+d);v.val("")};W.prototype.ajax=function(af,aj,ah,ak,v,al,ag,am){var ai=this;var ao=H("."+Q+' dl[xid="'+af+'"]').parents("."+E);if(!ao[0]||!aj){return}var ap=m[af]?m[af]:J;var ae=H.extend(true,{},ap.data);ae[ap.searchName]=ah;H.ajax({type:ap.type,headers:ap.header,url:aj,data:ap.dataType=="json"?JSON.stringify(ae):ae,success:function aq(ar){if(typeof ar=="string"){ar=JSON.parse(ar)}ap.beforeSuccess&&ap.beforeSuccess instanceof Function&&(ar=ap.beforeSuccess(af,aj,ah,ar));if(ai.isArray(ar)){var at={};at[ap.response.statusName]=ap.response.statusCode;at[ap.response.msgName]="";at[ap.response.dataName]=ar;ar=at}if(ar[ap.response.statusName]!=ap.response.statusCode){ao.find("dd."+M).addClass(Z).text(ar[ap.response.msgName])}else{ao.find("dd."+M).removeClass(Z);ai.renderData(af,ar[ap.response.dataName],ak,v,al,am);aa[af].config.isEmpty=ar[ap.response.dataName].length==0}ag&&ag(af);ap.success&&ap.success instanceof Function&&ap.success(af,aj,ah,ar)},error:function an(ar){ao.find("dd[lay-value]:not(."+u+")").remove();ao.find("dd."+M).addClass(Z).text("服务异常");ap.error&&ap.error instanceof Function&&ap.error(af,aj,ah,ar)}})};W.prototype.renderData=function(af,ae,ag,v,aj,al){var ah=this;if(ag){this.renderLinkage(af,ae,v);return}if(al){this.renderReplace(af,ae);return}var an=H("."+Q+' dl[xid="'+af+'"]').parents("."+E);var ap=m[af]?m[af]:J;var ak=an.find("."+V+" input");ae=this.exchangeData(af,ae);var aq=[];an.find("dl").html(this.renderSelect(af,ak.attr("placeholder")||ak.attr("back"),ae.map(function(at){var ar=H.extend({},at,{innerHTML:at[ap.keyName],value:at[ap.keyVal],sel:at[ap.keySel],disabled:at[ap.keyDis],type:at.type,name:at[ap.keyName]});if(ar.sel){aq.push(ar)}return ar})));var am=an.find("."+Y);var ai=an.find("dl[xid]");if(aj){var ao=aa[af].values;ao.forEach(function(at,ar){ai.find('dd[lay-value="'+at.value+'"]').addClass(s)});aq.forEach(function(at,ar){if(ah.indexOf(ao,at)==-1){ah.addLabel(af,am,at);ai.find('dd[lay-value="'+at.value+'"]').addClass(s);ao.push(at)}})}else{aq.forEach(function(at,ar){ah.addLabel(af,am,at);ai.find('dd[lay-value="'+at.value+'"]').addClass(s)});aa[af].values=aq}this.commonHandler(af,am)};W.prototype.renderLinkage=function(af,ae,v){var am=[],ai=0,al={"0":ae},ak=m[af]?m[af]:J;i[af]={};var ag=function ag(){var ao=am[ai++]=[],an=al;al={};H.each(an,function(aq,ap){H.each(ap,function(ar,au){var av={pid:aq,name:au[ak.keyName],value:au[ak.keyVal]};i[af][av.value]=H.extend(au,av);ao.push(av);var at=au[ak.keyChildren];if(at&&at.length){al[av.value]=at}})})};do{ag()}while(Object.getOwnPropertyNames(al).length);var aj=H("."+Q+' dl[xid="'+af+'"]').parents("."+E);var ah=['<div class="xm-select-linkage">'];H.each(am,function(ao,an){var ap=['<div style="left: '+(v-0)*ao+'px;" class="xm-select-linkage-group xm-select-linkage-group'+(ao+1)+" "+(ao!=0?"xm-select-linkage-hide":"")+'">'];H.each(an,function(aq,at){var ar='<li title="'+at.name+'" pid="'+at.pid+'" xm-value="'+at.value+'"><span>'+at.name+"</span></li>";ap.push(ar)});ap.push("</div>");ah=ah.concat(ap)});ah.push('<div style="clear: both; height: 288px;"></div>');ah.push("</div>");aj.find("dl").html(ah.join(""));aj.find("."+d).css("display","none")};W.prototype.renderReplace=function(ai,ah){var v=this;var af=H("."+Q+' dl[xid="'+ai+'"]');var ae=m[ai]?m[ai]:J;ah=this.exchangeData(ai,ah);i[ai]=ah;var ag=ah.map(function(ak){var aj=H.extend({},ak,{innerHTML:ak[ae.keyName],value:ak[ae.keyVal],sel:ak[ae.keySel],disabled:ak[ae.keyDis],type:ak.type,name:ak[ae.keyName]});return v.createDD(ai,aj)}).join("");af.find("dd:not(."+u+"),dt:not([style])").remove();af.find("dt[style]").after(H(ag))};W.prototype.exchangeData=function(ai,ae){var af=m[ai]?m[ai]:J;var ag=af.keyChildren;var ah=af.keyDis;i[ai]={};var v=this.getChildrenList(ae,ag,ah,[],false);return v};W.prototype.getChildrenList=function(aj,v,an,ai,ah){var ap=[],ag=0;for(var al=0;al<aj.length;al++){var am=aj[al];if(am.type&&am.type=="optgroup"){ap.push(am);continue}else{ag++}var ao=ai.concat([]);ao.push(ag-1+"_E");am[h]=JSON.stringify(ao);am[an]=am[an]||ah;ap.push(am);var ae=am[v];if(ae&&t.isArray(ae)&&ae.length){am.XM_TREE_FOLDER=true;var ak=ao.concat([]);var af=this.getChildrenList(ae,v,an,ak,am[an]);ap=ap.concat(af)}}return ap};W.prototype.create=function(af,ae,ah){if(ae&&ah){var aj=aa[af],ai=H('[xid="'+af+'"]'),ak=ai.find("dd."+u+"."+F),v=null,al=ai.find("dd."+A);ai.find("dd:not(."+u+"):not(."+A+")").each(function(am,an){if(ah==H(an).find("span").attr("name")){v=an}});if(!v){var ag=aj.config.create(af,ah);if(al[0]){al.attr("lay-value",ag);al.find("span").text(ah);al.find("span").attr("name",ah);al.removeClass(w)}else{ak.after(H(this.createDD(af,{name:ah,innerHTML:ah,value:ag},A+" "+o)))}}}else{H("[xid="+af+"] dd."+A).remove()}};W.prototype.createDD=function(ak,aj,ai){var ag=m[ak]?m[ak]:J;var af=H.trim(aj.innerHTML);i[ak][aj.value]=H(aj).is("option")?aj=function(){var al={};al[ag.keyName]=af;al[ag.keyVal]=aj.value;al[ag.keyDis]=aj.disabled;return al}():aj;var ah=aa[ak].config.template(ak,aj);var ae=aj[h];ae?ae=JSON.parse(ae):ae=[-1];var v=ae[0]==-1?"":'tree-id="'+ae.join("-")+'" tree-folder="'+!!aj.XM_TREE_FOLDER+'"';return'<dd lay-value="'+aj.value+'" class="'+(aj.disabled?G:"")+" "+(ai?ai:"")+'" '+v+'>\n\t\t\t\t\t<div class="xm-unselect xm-form-checkbox '+(aj.disabled?G:"")+'"  style="margin-left: '+(ae.length-1)*30+'px">\n\t\t\t\t\t\t<i class="'+q+'"></i>\n\t\t\t\t\t\t<span name="'+af+'">'+ah+"</span>\n\t\t\t\t\t</div>\n\t\t\t\t</dd>"};W.prototype.createQuickBtn=function(ae,v){return'<div class="'+e+'" method="'+ae.name+'" title="'+ae.name+'" '+(v?'style="margin-right: '+v+'"':"")+'><i class="'+ae.icon+'"></i><span>'+ae.name+"</span></div>"};W.prototype.renderBtns=function(ai,ae,ag){var v=this;var ah=[];var af=H('dl[xid="'+ai+'"]');ah.push('<div class="'+ad+'" show="'+ae+'" style="max-width: '+(af.prev().width()-54)+'px;">');H.each(aa[ai].config.btns,function(aj,ak){ah.push(v.createQuickBtn(ak,ag))});ah.push("</div>");ah.push(this.createQuickBtn({icon:"xm-iconfont icon-caidan",name:""}));return ah.join("")};W.prototype.renderSelect=function(ah,af,ae){var ag=this;i[ah]={};var v=[];if(aa[ah].config.btns.length){setTimeout(function(){var ai=H('dl[xid="'+ah+'"]');ai.parents("."+E).attr(k,aa[ah].config.searchType);ai.find("."+ad).css("max-width",ai.prev().width()-54+"px")},10);v.push(['<dd lay-value="" class="'+u+'" style="background-color: #FFF!important;">',this.renderBtns(ah,null,"30px"),"</dd>",'<dd lay-value="" class="'+u+" "+F+'" style="background-color: #FFF!important;">','<i class="xm-iconfont icon-sousuo"></i>','<input type="text" class="'+ac+" "+d+'" placeholder="\u8BF7\u641C\u7D22"/>',"</dd>"].join(""))}else{v.push('<dd lay-value="" class="'+u+'">'+af+"</dd>")}if(this.isArray(ae)){H(ae).each(function(ai,aj){if(aj){if(aj.type&&aj.type==="optgroup"){v.push("<dt>"+aj.name+"</dt>")}else{v.push(ag.createDD(ah,aj))}}})}else{H(ae).find("*").each(function(ai,aj){if(aj.tagName.toLowerCase()=="option"&&ai==0&&!aj.value){return}if(aj.tagName.toLowerCase()==="optgroup"){v.push("<dt>"+aj.label+"</dt>")}else{v.push(ag.createDD(ah,aj))}})}v.push('<dt style="display:none;"> </dt>');v.push('<dd class="'+u+" "+M+" "+(v.length===2?Z:"")+'">\u6CA1\u6709\u9009\u9879</dd>');return v.join("")};W.prototype.on=function(){var v=this;this.one();H(document).on("click",function(ae){if(!H(ae.target).parents("."+B)[0]){H("."+Q+" dl ."+w).removeClass(w);H("."+Q+" dl dd."+Z).removeClass(Z);H("."+Q+" dl dd."+A).remove();H.each(aa,function(ag,af){v.clearInput(ag);if(!af.values.length){v.changePlaceHolder(H('div[FS_ID="'+ag+'"] .'+Y))}})}H("."+Q+" ."+r).each(function(af,ag){v.changeShow(H(ag).find("."+B),false)})})};W.prototype.calcLabelLeft=function(ai,ak,al){var ag=this.getPosition(ai[0]);ag.y=ag.x+ai[0].clientWidth;var v=ai[0].offsetLeft;if(!ai.find("span").length){v=0}else{if(al){var aj=ai.find("span:last");aj.css("display")=="none"?aj=aj.prev()[0]:aj=aj[0];var ah=this.getPosition(aj);ah.y=ah.x+aj.clientWidth;if(ah.y>ag.y){v=v-(ah.y-ag.y)-5}else{v=0}}else{if(ak<0){var af=ai.find(":last");af.css("display")=="none"?af=af.prev()[0]:af=af[0];var ae=this.getPosition(af);ae.y=ae.x+af.clientWidth;if(ae.y>ag.y){v-=10}}else{if(v<0){v+=10}if(v>0){v=0}}}}ai.css("left",v+"px")};W.prototype.one=function(ae){var v=this;H(ae?ae:document).off("click","."+B).on("click","."+B,function(al){var ah=H(al.target),an=ah.is(B)?ah:ah.parents("."+B),ak=an.next(),ag=ak.attr("xid");H("dl[xid]").not(ak).each(function(aq,ar){v.clearInput(H(ar).attr("xid"))});H("dl[xid]").not(ak).find("dd."+w).removeClass(w);if(an.hasClass(p)){return false}if(ah.is("."+g)||ah.is("."+d+"[readonly]")){v.changeShow(an,!an.parents("."+E).hasClass(r));return false}if(an.find("."+d+":not(readonly)")[0]){var ao=an.find("."+d),aj={x:al.pageX,y:al.pageY},am=v.getPosition(an[0]),af=an.width();while(aj.x>am.x){if(H(document.elementFromPoint(aj.x,aj.y)).is(ao)){ao.focus();v.changeShow(an,true);return false}aj.x-=50}}if(ah.is("."+d)){v.changeShow(an,true);return false}if(ah.is('i[fsw="'+K+'"]')){var ai=v.getItem(ag,ah),ap=ak.find("dd[lay-value='"+ai.value+"']");if(ap.hasClass(G)){return false}v.handlerLabel(ag,ap,false,ai);return false}v.changeShow(an,!an.parents("."+E).hasClass(r));return false});H(ae?ae:document).off("click","dl."+b).on("click","dl."+b,function(ay){var ar=H(ay.target);if(ar.is("."+U)||ar.parents("."+U)[0]){ar=ar.is("li")?ar:ar.parents("li[xm-value]");var aA=ar.parents(".xm-select-linkage-group"),ak=ar.parents("dl").attr("xid");if(!ak){return false}aA.find(".xm-select-active").removeClass("xm-select-active");ar.addClass("xm-select-active");aA.nextAll(".xm-select-linkage-group").addClass("xm-select-linkage-hide");var ao=aA.next(".xm-select-linkage-group");ao.find("li").addClass("xm-select-linkage-hide");ao.find('li[pid="'+ar.attr("xm-value")+'"]').removeClass("xm-select-linkage-hide");if(!ao[0]||ao.find("li:not(.xm-select-linkage-hide)").length==0){var aq=[],am=0,aw=!ar.hasClass("xm-select-this");if(aa[ak].config.radio){ar.parents(".xm-select-linkage").find(".xm-select-this").removeClass("xm-select-this")}do{aq[am++]={name:ar.find("span").text(),value:ar.attr("xm-value")};ar=ar.parents(".xm-select-linkage-group").prev().find('li[xm-value="'+ar.attr("pid")+'"]')}while(ar.length);aq.reverse();var aB={name:aq.map(function(aC){return aC.name}).join("/"),value:aq.map(function(aC){return aC.value}).join("/")};v.handlerLabel(ak,null,aw,aB)}else{ao.removeClass("xm-select-linkage-hide")}return false}if(ar.is("dl")){return false}if(ar.is("dt")){ar.nextUntil("dt").each(function(aC,aD){aD=H(aD);if(aD.hasClass(G)||aD.hasClass(s)){}else{aD.find("i:not(.icon-expand)").click()}});return false}var az=ar.is("dd")?ar:ar.parents("dd");var at=az.parent("dl").attr("xid");if(az.hasClass(G)){return false}if(ar.is("i.icon-caidan")){var af=[],ax=[];ar.parents("dl").find('dd[tree-folder="true"]').each(function(aC,aD){H(aD).attr("xm-tree-hidn")==undefined?af.push(aD):ax.push(aD)});var ag=ax.length?ax:af;ag.forEach(function(aC){return aC.click()});return false}var al=az.attr("tree-id");if(al){if(ar.is("i:not(.icon-expand)")){v.handlerLabel(at,az,!az.hasClass(s));return false}var au=m[at]||J;var ah=au.tree;var ai=az.nextAll('dd[tree-id^="'+al+'"]');if(ai&&ai.length){var av=ai[0].clientHeight;av?(v.addTreeHeight(az,av),av=0):(av=az.attr("xm-tree-hidn")||36,az.removeAttr("xm-tree-hidn"),az.find(">i").remove(),ai=ai.filter(function(aC,aD){return H(aD).attr("tree-id").split("-").length-1==al.split("-").length}));ai.animate({height:av},150);return false}else{if(ah.nextClick&&ah.nextClick instanceof Function){ah.nextClick(at,v.getItem(at,az),function(aC){if(!aC||!aC.length){v.handlerLabel(at,az,!az.hasClass(s))}else{az.attr("tree-folder","true");var aD=[];aC.forEach(function(aF,aE){aF.innerHTML=aF[au.keyName];aF[h]=JSON.stringify(al.split("-").concat([aE]));aD.push(v.createDD(at,aF));i[at][aF[au.keyVal]]=aF});az.after(aD.join(""))}});return false}}}if(az.hasClass(u)){var an=ar.is("."+e)?ar:ar.parents("."+e);if(!an[0]){return false}var aj=an.attr("method");var ap=aa[at].config.btns.filter(function(aC){return aC.name==aj})[0];ap&&ap.click&&ap.click instanceof Function&&ap.click(at,v);return false}v.handlerLabel(at,az,!az.hasClass(s));return false})};W.prototype.addTreeHeight=function(ae,v){var af=this;var ag=ae.attr("tree-id");var ah=ae.nextAll('dd[tree-id^="'+ag+'"]');if(ah.length){ae.append('<i class="xm-iconfont icon-expand"></i>');ae.attr("xm-tree-hidn",v);ah.each(function(ai,ak){var aj=H(ak);af.addTreeHeight(aj,v)})}};var i={};W.prototype.getItem=function(ag,ae){if(ae instanceof H){if(ae.is('i[fsw="'+K+'"]')){var v=ae.parent();return i[ag][ae]||{name:v.find("font").text(),value:v.attr("value")}}var af=ae.attr("lay-value");return !i[ag][af]?i[ag][af]={name:ae.find("span[name]").attr("name"),value:af}:i[ag][af]}else{if(typeof ae=="string"&&ae.indexOf("/")!=-1){return i[ag][ae]||{name:this.valToName(ag,ae),value:ae}}}return i[ag][ae]};W.prototype.linkageAdd=function(ak,ai){var ah=H('dl[xid="'+ak+'"]');ah.find(".xm-select-active").removeClass("xm-select-active");var aj=ai.value.split("/");var ae=void 0,v=void 0,ag=0;var af=[];do{ae=aj[ag];v=ah.find(".xm-select-linkage-group"+(ag+1)+' li[xm-value="'+ae+'"]');v[0]&&af.push(v);ag++}while(v.length&&ae!=undefined);if(af.length==aj.length){H.each(af,function(al,am){am.addClass("xm-select-this")})}};W.prototype.linkageDel=function(aj,ah){var ag=H('dl[xid="'+aj+'"]');var ai=ah.value.split("/");var ae=void 0,v=void 0,af=ai.length-1;do{ae=ai[af];v=ag.find(".xm-select-linkage-group"+(af+1)+' li[xm-value="'+ae+'"]');if(!v.parent().next().find("li[pid="+ae+"].xm-select-this").length){v.removeClass("xm-select-this")}af--}while(v.length&&ae!=undefined)};W.prototype.valToName=function(ah,af){var v=H('dl[xid="'+ah+'"]');var ag=(af+"").split("/");if(!ag.length){return null}var ae=[];H.each(ag,function(ai,ak){var aj=v.find(".xm-select-linkage-group"+(ai+1)+' li[xm-value="'+ak+'"] span').text();ae.push(aj)});return ae.length==ag.length?ae.join("/"):null};W.prototype.commonHandler=function(ae,v){if(!v||!v[0]){return}this.checkHideSpan(ae,v);this.changePlaceHolder(v);this.retop(v.parents("."+E));this.calcLabelLeft(v,0,true);this.setHidnVal(ae,v);v.parents("."+B+" ."+K).attr("title",aa[ae].values.map(function(af){return af.name}).join(","))};W.prototype.initVal=function(af){var v=this;var ae={};if(af){ae[af]=aa[af]}else{ae=aa}H.each(ae,function(aj,al){var ag=al.values,am=H('dl[xid="'+aj+'"]').parent(),ai=am.find("."+Y),ah=am.find("dl");ah.find("dd."+s).removeClass(s);var ak=ag.concat([]);ak.concat([]).forEach(function(ao,an){v.addLabel(aj,ai,ao);ah.find('dd[lay-value="'+ao.value+'"]').addClass(s)});if(al.config.radio){ak.length&&ag.push(ak[ak.length-1])}v.commonHandler(aj,ai)})};W.prototype.setHidnVal=function(ae,v){if(!v||!v[0]){return}v.parents("."+Q).find("."+O).val(aa[ae].values.map(function(af){return af.value}).join(","))};W.prototype.handlerLabel=function(ae,ao,an,ag,ah){var v=H('[xid="'+ae+'"]').prev().find("."+Y),af=ao&&this.getItem(ae,ao),al=aa[ae].values,ak=aa[ae].config.on||y.on[ae],ap=aa[ae].config.endOn||y.endOn[ae];if(ag){af=ag}var aj=aa[ae];if(an&&aj.config.max&&aj.values.length>=aj.config.max){var am=y.maxTips[ae]||aa[ae].config.maxTips;am&&am(ae,al.concat([]),af,aj.config.max);return}if(!ah){if(ak&&ak instanceof Function&&ak(ae,al.concat([]),af,an,ao&&ao.hasClass(G))==false){return}}var ai=H('dl[xid="'+ae+'"]');an?(ao&&ao[0]?(ao.addClass(s),ao.removeClass(A)):ai.find(".xm-select-linkage")[0]&&this.linkageAdd(ae,af),this.addLabel(ae,v,af),al.push(af)):(ao&&ao[0]?ao.removeClass(s):ai.find(".xm-select-linkage")[0]&&this.linkageDel(ae,af),this.delLabel(ae,v,af),this.remove(al,af));if(!v[0]){return}if(aj.config.radio){this.changeShow(v,false)}v.parents("."+B).prev().removeClass("layui-form-danger");aj.config.clearInput&&this.clearInput(ae);this.commonHandler(ae,v);!ah&&ap&&ap instanceof Function&&ap(ae,al.concat([]),af,an,ao&&ao.hasClass(G))};W.prototype.addLabel=function(ak,aj,ai){if(!ai){return}var af='fsw="'+K+'"';var ah=[H("<span "+af+' value="'+ai.value+'"><font '+af+">"+ai.name+"</font></span>"),H("<i "+af+' class="xm-iconfont icon-close"></i>')],ae=ah[0],ag=ah[1];ae.append(ag);var v=aa[ak];if(v.config.radio){v.values.length=0;H('dl[xid="'+ak+'"]').find("dd."+s+':not([lay-value="'+ai.value+'"])').removeClass(s);aj.find("span").remove()}aj.find("input").css("width","50px");aj.find("input").before(ae)};W.prototype.delLabel=function(af,ae,v){if(!v){return}ae.find('span[value="'+v.value+'"]:first').remove()};W.prototype.checkHideSpan=function(ah,ag){var v=ag.parents("."+K)[0].offsetHeight+5;ag.find("span.xm-span-hide").removeClass("xm-span-hide");ag.find("span[style]").remove();var ae=aa[ah].config.showCount;ag.find("span").each(function(ai,aj){if(ai>=ae){H(aj).addClass("xm-span-hide")}});var af=ag.find("span:eq("+ae+")");af[0]&&af.before(H('<span style="padding-right: 6px;" fsw="'+K+'"> + '+(ag.find("span").length-ae)+"</span>"))};W.prototype.retop=function(ak){var ag=ak.find("dl"),ai=ak.offset().top+ak.outerHeight()+5-C.scrollTop(),af=ag.outerHeight();var ae=ak.hasClass("layui-form-selectup")||ag.css("top").indexOf("-")!=-1||ai+af>C.height()&&ai>=af;ak=ak.find("."+K);var v=aa[ag.attr("xid")];var ah=ag.parents(".layui-form-pane")[0]&&ag.prev()[0].clientHeight>38?14:10;if(v&&v.config.direction=="up"||ae){ae=true;if(v&&v.config.direction=="down"){ae=false}}var aj=ak[0].offsetTop+ak.height()+ah;if(ae){ag.css({top:"auto",bottom:aj+3+"px"})}else{ag.css({top:aj+"px",bottom:"auto"})}};W.prototype.changeShow=function(ah,ae){H(".layui-form-selected").removeClass("layui-form-selected");var ai=ah.parents("."+E),v=ai.hasClass(r),aj=ai.find("dl").attr("xid");H("."+Q+" ."+E).not(ai).removeClass(r);if(ae){this.retop(ai);ai.addClass(r);ai.find("."+d).focus();if(!ai.find("dl dd[lay-value]:not(."+u+")").length){ai.find("dl ."+M).addClass(Z)}}else{ai.removeClass(r);this.clearInput(aj);ai.find("dl ."+Z).removeClass(Z);ai.find("dl dd."+w).removeClass(w);ai.find("dl dd."+A).remove();if(aj&&aa[aj]&&aa[aj].config.isEmpty){this.triggerSearch(ai)}this.changePlaceHolder(ai.find("."+Y))}if(ae!=v){var ag=aa[aj].config.opened||y.opened[aj];ae&&ag&&ag instanceof Function&&ag(aj);var af=aa[aj].config.closed||y.closed[aj];!ae&&af&&af instanceof Function&&af(aj)}};W.prototype.changePlaceHolder=function(v){var ai=v.parents("."+B);ai[0]||(ai=v.parents("dl").prev());if(!ai[0]){return}var ae=v.parents("."+Q).find("dl[xid]").attr("xid");if(aa[ae]&&aa[ae].config.height){}else{var al=ai.find("."+K)[0].clientHeight;ai.css("height",(al>36?al+4:al)+"px");var aj=ai.parents("."+Q).parent().prev();if(aj.is(".layui-form-label")&&ai.parents(".layui-form-pane")[0]){al=al>36?al+4:al;ai.css("height",al+"px");aj.css({height:al+2+"px",lineHeight:al-18+"px"})}}var ak=ai.find("."+V+" input"),ag=!v.find("span:last")[0]&&!ai.find("."+d).val();if(ag){var ah=ak.attr("back");ak.removeAttr("back");ak.attr("placeholder",ah)}else{var af=ak.attr("placeholder");ak.removeAttr("placeholder");ak.attr("back",af)}};W.prototype.indexOf=function(v,af){for(var ae=0;ae<v.length;ae++){if(v[ae].value==af||v[ae].value==(af?af.value:af)||v[ae]==af||JSON.stringify(v[ae])==JSON.stringify(af)){return ae}}return -1};W.prototype.remove=function(ae,af){var v=this.indexOf(ae,af?af.value:af);if(v>-1){ae.splice(v,1);return true}return false};W.prototype.selectAll=function(ah,ag,af){var ae=this;var v=H('[xid="'+ah+'"]');if(!v[0]){return}if(v.find(".xm-select-linkage")[0]){return}v.find("dd[lay-value]:not(."+u+"):not(."+s+")"+(af?":not(."+G+")":"")).each(function(ai,aj){aj=H(aj);var ak=ae.getItem(ah,aj);ae.handlerLabel(ah,v.find('dd[lay-value="'+ak.value+'"]'),true,ak,!ag)})};W.prototype.removeAll=function(ah,ag,af){var ae=this;var v=H('[xid="'+ah+'"]');if(!v[0]){return}if(v.find(".xm-select-linkage")[0]){aa[ah].values.concat([]).forEach(function(am,aj){var an=am.value.split("/");var ak=void 0,ai=void 0,al=0;do{ak=an[al++];ai=v.find(".xm-select-linkage-group"+al+':not(.xm-select-linkage-hide) li[xm-value="'+ak+'"]');ai.click()}while(ai.length&&ak!=undefined)});return}aa[ah].values.concat([]).forEach(function(aj,ai){if(af&&v.find('dd[lay-value="'+aj.value+'"]').hasClass(G)){}else{ae.handlerLabel(ah,v.find('dd[lay-value="'+aj.value+'"]'),false,aj,!ag)}})};W.prototype.reverse=function(ah,ag,af){var v=this;var ae=H('[xid="'+ah+'"]');if(!ae[0]){return}if(ae.find(".xm-select-linkage")[0]){return}ae.find("dd[lay-value]:not(."+u+")"+(af?":not(."+G+")":"")).each(function(ai,aj){aj=H(aj);var ak=v.getItem(ah,aj);v.handlerLabel(ah,ae.find('dd[lay-value="'+ak.value+'"]'),!aj.hasClass(s),ak,!ag)})};W.prototype.skin=function(af){var ae=["default","primary","normal","warm","danger"];var v=ae[Math.floor(Math.random()*ae.length)];H('dl[xid="'+af+'"]').parents("."+Q).find("."+E).attr("xm-select-skin",v);this.check(af)&&this.commonHandler(af,H('dl[xid="'+af+'"]').parents("."+Q).find("."+Y))};W.prototype.getPosition=function(ae){var v=0,af=0;while(ae!=null){v+=ae.offsetLeft;af+=ae.offsetTop;ae=ae.offsetParent}return{x:v,y:af}};W.prototype.onreset=function(){H(document).on("click","[type=reset]",function(v){H(v.target).parents("form").find("."+Q+" dl[xid]").each(function(ah,ai){var aj=ai.getAttribute("xid"),ag=H(ai),ae=void 0,af={};t.removeAll(aj);aa[aj].config.init.forEach(function(al,ak){if(al&&(!af[al]||aa[aj].config.repeat)&&(ae=ag.find('dd[lay-value="'+al.value+'"]'))[0]){t.handlerLabel(aj,ae,true);af[al]=1}})})})};W.prototype.bindEvent=function(ae,af,v){if(af&&af instanceof Function){v=af;af=null}if(v&&v instanceof Function){if(!af){H.each(aa,function(ah,ag){aa[ah]?aa[ah].config[ae]=v:y[ae][ah]=v})}else{aa[af]?(aa[af].config[ae]=v,delete y[ae][af]):y[ae][af]=v}}};W.prototype.check=function(ae,v){if(H('dl[xid="'+ae+'"]').length){return true}else{if(H('select[xm-select="'+ae+'"]').length){if(!v){this.render(ae,H('select[xm-select="'+ae+'"]'));return true}}else{delete aa[ae];return false}}};W.prototype.render=function(ae,v){t.init(v);t.one(H('dl[xid="'+ae+'"]').parents("."+Q));t.initVal(ae)};W.prototype.log=function(v){console.log(v)};var l=function l(){this.v=S;this.render()};var t=new W();l.prototype.value=function(v,ah,ai){if(typeof v!="string"){return[]}var ag=aa[v];if(!t.check(v)){return[]}if(typeof ah=="string"||ah==undefined){var ae=ag.values.concat([])||[];if(ah=="val"){return ae.map(function(am){return am.value})}if(ah=="valStr"){return ae.map(function(am){return am.value}).join(",")}if(ah=="name"){return ae.map(function(am){return am.name})}if(ah=="nameStr"){return ae.map(function(am){return am.name}).join(",")}return ae}if(t.isArray(ah)){var af=H('[xid="'+v+'"]'),al={},ak=void 0,aj=true;if(ai==false){aj=false}else{if(ai==true){aj=true}else{t.removeAll(v)}}if(aj){ag.values.forEach(function(an,am){al[an.value]=1})}ah.forEach(function(ao,an){if(ao&&(!al[ao]||ag.config.repeat)){if((ak=af.find('dd[lay-value="'+ao+'"]'))[0]){t.handlerLabel(v,ak,aj,null,true);al[ao]=1}else{var am=t.valToName(v,ao);if(am){t.handlerLabel(v,ak,aj,t.getItem(v,ao),true);al[ao]=1}}}})}};l.prototype.on=function(af,v,ae){t.bindEvent(ae?"endOn":"on",af,v);return this};l.prototype.filter=function(ae,v){t.bindEvent("filter",ae,v);return this};l.prototype.maxTips=function(ae,v){t.bindEvent("maxTips",ae,v);return this};l.prototype.opened=function(ae,v){t.bindEvent("opened",ae,v);return this};l.prototype.closed=function(ae,v){t.bindEvent("closed",ae,v);return this};l.prototype.config=function(af,v,ae){if(af&&(typeof af==="undefined"?"undefined":_typeof(af))=="object"){ae=v==true;v=af;af=null}if(v&&(typeof v==="undefined"?"undefined":_typeof(v))=="object"){if(ae){v.header||(v.header={});v.header["Content-Type"]="application/json; charset=UTF-8";v.dataType="json"}af?(m[af]=H.extend(true,{},m[af]||J,v),!t.check(af)&&this.render(af),aa[af]&&v.direction&&(aa[af].config.direction=v.direction),aa[af]&&v.clearInput&&(aa[af].config.clearInput=true),v.searchUrl&&aa[af]&&t.triggerSearch(H("."+Q+' dl[xid="'+af+'"]').parents("."+E),true)):(H.extend(true,J,v),H.each(m,function(ag,ah){H.extend(true,ah,v)}))}return this};l.prototype.render=function(ag,ae){var af;if(ag&&(typeof ag==="undefined"?"undefined":_typeof(ag))=="object"){ae=ag;ag=null}var v=ae?(af={init:ae.init,disabled:ae.disabled,max:ae.max,isSearch:ae.isSearch,searchUrl:ae.searchUrl,isCreate:ae.isCreate,radio:ae.radio,skin:ae.skin,direction:ae.direction,height:ae.height,formname:ae.formname,layverify:ae.layverify,layverType:ae.layverType,showCount:ae.showCount,placeholder:ae.placeholder,create:ae.create,filter:ae.filter,maxTips:ae.maxTips,on:ae.on},_defineProperty(af,"on",ae.on),_defineProperty(af,"opened",ae.opened),_defineProperty(af,"closed",ae.closed),_defineProperty(af,"template",ae.template),_defineProperty(af,"clearInput",ae.clearInput),af):{};ae&&ae.searchType!=undefined&&(v.searchType=ae.searchType=="dl"?1:0);if(ag){N[ag]={};H.extend(N[ag],aa[ag]?aa[ag].config:{},v)}else{H.extend(x,v)}(H("select["+K+'="'+ag+'"]')[0]?H("select["+K+'="'+ag+'"]'):H("select["+K+"]")).each(function(aj,ah){var ai=ah.getAttribute(K);t.render(ai,ah);setTimeout(function(){return t.setHidnVal(ai,H('select[xm-select="'+ai+'"] + div.'+Q+" ."+Y))},10)});return this};l.prototype.disabled=function(ae){var v={};ae?t.check(ae)&&(v[ae]=aa[ae]):v=aa;H.each(v,function(af,ag){H('dl[xid="'+af+'"]').prev().addClass(p)});return this};l.prototype.undisabled=function(ae){var v={};ae?t.check(ae)&&(v[ae]=aa[ae]):v=aa;H.each(v,function(af,ag){H('dl[xid="'+af+'"]').prev().removeClass(p)});return this};l.prototype.data=function(af,ae,v){if(!af||!ae||!v){t.log("id: "+af+" param error !!!");return this}if(!t.check(af)){t.log("id: "+af+" not render !!!");return this}this.value(af,[]);this.config(af,v);if(ae=="local"){t.renderData(af,v.arr,v.linkage==true,v.linkageWidth?v.linkageWidth:"100")}else{if(ae=="server"){t.ajax(af,v.url,v.keyword,v.linkage==true,v.linkageWidth?v.linkageWidth:"100")}}return this};l.prototype.btns=function(ag,ae,v){if(ag&&t.isArray(ag)){ae=ag;ag=null}if(!ae||!t.isArray(ae)){return this}var af={};ag?t.check(ag)&&(af[ag]=aa[ag]):af=aa;ae=ae.map(function(ah){if(typeof ah=="string"){if(ah=="select"){return X[0]}if(ah=="remove"){return X[1]}if(ah=="reverse"){return X[2]}if(ah=="skin"){return X[3]}}return ah});H.each(af,function(al,an){an.config.btns=ae;var ah=H('dl[xid="'+al+'"]').find("."+u+":first");if(ae.length){var ai=v&&v.show&&(v.show=="name"||v.show=="icon")?v.show:"";var ak=t.renderBtns(al,ai,v&&v.space?v.space:"30px");ah.html(ak)}else{var am=ah.parents("."+E).find("."+V+" input");var aj=am.attr("placeholder")||am.attr("back");ah.html(aj);ah.removeAttr("style")}});return this};l.prototype.search=function(ae,v){if(ae&&t.check(ae)){m[ae]=H.extend(true,{},m[ae]||J,{first:true,searchVal:v});t.triggerSearch(H('dl[xid="'+ae+'"]').parents("."+E),true)}return this};l.prototype.replace=function(ah,af,ae){var v=this;if(!ah||!af||!ae){t.log("id: "+ah+" param error !!!");return this}if(!t.check(ah,true)){t.log("id: "+ah+" not render !!!");return this}var ag=this.value(ah,"val");this.value(ah,[]);this.config(ah,ae);if(af=="local"){t.renderData(ah,ae.arr,ae.linkage==true,ae.linkageWidth?ae.linkageWidth:"100",false,true);this.value(ah,ag,true)}else{if(af=="server"){t.ajax(ah,ae.url,ae.keyword,ae.linkage==true,ae.linkageWidth?ae.linkageWidth:"100",false,function(ai){v.value(ai,ag,true)},true)}}};return new l()});