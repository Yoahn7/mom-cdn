layui.define(["laytpl","form"],function(G){var J=layui.$,m=layui.laytpl,B=layui.form,D="transfer",C={config:{},index:layui[D]?layui[D].index+10000:0,set:function(c){var a=this;return a.config=J.extend({},a.config,c),a},on:function(d,c){return layui.onevent.call(this,D,d,c)}},w=function(){var f=this,c=f.config,d=c.id||f.index;return w.that[d]=f,w.config[d]=c,{config:c,reload:function(e){f.reload.call(f,e)},getData:function(){return f.getData.call(f)}}},I="layui-hide",A="layui-btn-disabled",H="layui-none",q="layui-transfer-box",k="layui-transfer-header",E="layui-transfer-search",F="layui-transfer-active",b="layui-transfer-data",z=function(a){return a=a||{},['<div class="layui-transfer-box" data-index="'+a.index+'">','<div class="layui-transfer-header">','<input type="checkbox" name="'+a.checkAllName+'" lay-filter="layTransferCheckbox" lay-type="all" lay-skin="primary" title="{{ d.data.title['+a.index+"] || 'list"+(a.index+1)+"' }}\">","</div>","{{# if(d.data.showSearch){ }}",'<div class="layui-transfer-search">','<i class="layui-icon layui-icon-search"></i>','<input type="input" class="layui-input" placeholder="关键词搜索">',"</div>","{{# } }}",'<ul class="layui-transfer-data"></ul>',"</div>"].join("")},j=['<div class="layui-transfer layui-form layui-border-box" lay-filter="LAY-transfer-{{ d.index }}">',z({index:0,checkAllName:"layTransferLeftCheckAll"}),'<div class="layui-transfer-active">','<button type="button" class="layui-btn layui-btn-sm layui-btn-primary layui-btn-disabled" data-index="0">','<i class="layui-icon layui-icon-next"></i>',"</button>",'<button type="button" class="layui-btn layui-btn-sm layui-btn-primary layui-btn-disabled" data-index="1">','<i class="layui-icon layui-icon-prev"></i>',"</button>","</div>",z({index:1,checkAllName:"layTransferRightCheckAll"}),"</div>"].join(""),g=function(c){var a=this;a.index=++C.index,a.config=J.extend({},a.config,C.config,c),a.render()};g.prototype.config={title:["列表一","列表二"],width:200,height:360,data:[],value:[],showSearch:!1,id:"",text:{none:"无数据",searchNone:"无匹配数据"}},g.prototype.reload=function(c){var a=this;layui.each(c,function(f,d){d.constructor===Array&&delete a.config[f]}),a.config=J.extend(!0,{},a.config,c),a.render()},g.prototype.render=function(){var d=this,f=d.config,c=d.elem=J(m(j).render({data:f,index:d.index})),a=f.elem=J(f.elem);a[0]&&(f.data=f.data||[],f.value=f.value||[],d.key=f.id||d.index,a.html(d.elem),d.layBox=d.elem.find("."+q),d.layHeader=d.elem.find("."+k),d.laySearch=d.elem.find("."+E),d.layData=c.find("."+b),d.layBtn=c.find("."+F+" .layui-btn"),d.layBox.css({width:f.width,height:f.height}),d.layData.css({height:function(){return f.height-d.layHeader.outerHeight()-d.laySearch.outerHeight()-2}()}),d.renderData(),d.events())},g.prototype.renderData=function(){var d=this,c=(d.config,[{checkName:"layTransferLeftCheck",views:[]},{checkName:"layTransferRightCheck",views:[]}]);d.parseData(function(f){var a=f.selected?1:0,h=["<li>",'<input type="checkbox" name="'+c[a].checkName+'" lay-skin="primary" lay-filter="layTransferCheckbox" title="'+f.title+'"'+(f.disabled?" disabled":"")+(f.checked?" checked":"")+' value="'+f.value+'">',"</li>"].join("");c[a].views.push(h),delete f.selected}),d.layData.eq(0).html(c[0].views.join("")),d.layData.eq(1).html(c[1].views.join("")),d.renderCheckBtn()},g.prototype.renderForm=function(a){B.render(a,"LAY-transfer-"+this.index)},g.prototype.renderCheckBtn=function(c){var a=this,d=a.config;c=c||{},a.layBox.each(function(n){var e=J(this),u=e.find("."+b),y=e.find("."+k).find('input[type="checkbox"]'),t=u.find('input[type="checkbox"]'),o=0,v=!1;if(t.each(function(){var f=J(this).data("hide");(this.checked||this.disabled||f)&&o++,this.checked&&!f&&(v=!0)}),y.prop("checked",v&&o===t.length),a.layBtn.eq(n)[v?"removeClass":"addClass"](A),!c.stopNone){var x=u.children("li:not(."+I+")").length;a.noneView(u,x?"":d.text.none)}}),a.renderForm("checkbox")},g.prototype.noneView=function(c,a){var d=J('<p class="layui-none">'+(a||"")+"</p>");c.find("."+H)[0]&&c.find("."+H).remove(),a.replace(/\s/g,"")&&c.append(d)},g.prototype.setValue=function(){var c=this,a=c.config,d=[];return c.layBox.eq(1).find("."+b+' input[type="checkbox"]').each(function(){var f=J(this).data("hide");f||d.push(this.value)}),a.value=d,c},g.prototype.parseData=function(d){var c=this,f=c.config,a=[];return layui.each(f.data,function(h,e){e=("function"==typeof f.parseData?f.parseData(e):e)||e,a.push(e=J.extend({},e)),layui.each(f.value,function(l,i){i==e.value&&(e.selected=!0)}),d&&d(e)}),f.data=a,c},g.prototype.getData=function(f){var c=this,d=c.config,h=[];return layui.each(f||d.value,function(l,i){layui.each(d.data,function(n,a){delete a.selected,i==a.value&&h.push(a)})}),h},g.prototype.events=function(){var c=this,a=c.config;c.elem.on("click",'input[lay-filter="layTransferCheckbox"]+',function(){var e=J(this).prev(),f=e[0].checked,d=e.parents("."+q).eq(0).find("."+b);e[0].disabled||("all"===e.attr("lay-type")&&d.find('input[type="checkbox"]').each(function(){this.disabled||(this.checked=f)}),c.renderCheckBtn({stopNone:!0}))}),c.layBtn.on("click",function(){var o=J(this),e=o.data("index"),d=c.layBox.eq(e),f=[];if(!o.hasClass(A)){c.layBox.eq(e).each(function(p){var r=J(this),l=r.find("."+b);l.children("li").each(function(){var u=J(this),v=u.find('input[type="checkbox"]'),s=v.data("hide");v[0].checked&&!s&&(v[0].checked=!1,d.siblings("."+q).find("."+b).append(u.clone()),u.remove(),f.push(v[0].value)),c.setValue()})}),c.renderCheckBtn();var h=d.siblings("."+q).find("."+E+" input");""===h.val()||h.trigger("keyup"),a.onchange&&a.onchange(c.getData(f),e)}}),c.laySearch.find("input").on("keyup",function(){var h=this.value,e=J(this).parents("."+E).eq(0).siblings("."+b),d=e.children("li");d.each(function(){var o=J(this),n=o.find('input[type="checkbox"]'),l=n[0].title.indexOf(h)!==-1;o[l?"removeClass":"addClass"](I),n.data("hide",!l)}),c.renderCheckBtn();var f=d.length===e.children("li."+I).length;c.noneView(e,f?a.text.searchNone:"")})},w.that={},w.config={},C.reload=function(f,c){var d=w.that[f];return d.reload(c),w.call(d)},C.getData=function(d){var c=w.that[d];return c.getData()},C.render=function(d){var c=new g(d);return w.call(c)},G(D,C)});