layui.define(["laytpl","laypage","layer","form","util"],function(ap){var ac=layui.$,al=layui.laytpl,au=layui.laypage,aj=layui.layer,ah=layui.form,ag=(layui.util,layui.hint()),ae=layui.device(),aq={config:{checkName:"LAY_CHECKED",indexName:"LAY_TABLE_INDEX"},cache:{},index:layui.table?layui.table.index+10000:0,set:function(b){var a=this;return a.config=ac.extend({},a.config,b),a},on:function(b,a){return layui.onevent.call(this,X,b,a)}},ar=function(){var c=this,b=c.config,a=b.id||b.index;return a&&(ar.that[a]=c,ar.config[a]=b),{config:b,reload:function(d){c.reload.call(c,d)},setColsWidth:function(){c.setColsWidth.call(c)},resize:function(){c.resize.call(c)}}},ad=function(b){var a=ar.config[b];return a||ag.error("The ID option was not found in the table instance"),a||null},ab=function(d,c,b,g){var f=d.templet?function(){return"function"==typeof d.templet?d.templet(b):al(ac(d.templet).html()||String(c)).render(b)}():c;return g?ac("<div>"+f+"</div>").text():f},X="table",am=".layui-table",ao="layui-hide",af="layui-none",aa="layui-table-view",ai=".layui-table-tool",an=".layui-table-box",at=".layui-table-init",Y=".layui-table-header",ak=".layui-table-body",Q=".layui-table-main",Z=".layui-table-fixed",q=".layui-table-fixed-l",U=".layui-table-fixed-r",J=".layui-table-total",G=".layui-table-page",B=".layui-table-sort",j="layui-table-edit",av="layui-table-hover",P=function(b){var a='{{#if(item2.colspan){}} colspan="{{item2.colspan}}"{{#} if(item2.rowspan){}} rowspan="{{item2.rowspan}}"{{#}}}';return b=b||{},['<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>',"<thead>","{{# layui.each(d.data.cols, function(i1, item1){ }}","<tr>","{{# layui.each(item1, function(i2, item2){ }}",'{{# if(item2.fixed && item2.fixed !== "right"){ left = true; } }}','{{# if(item2.fixed === "right"){ right = true; } }}',function(){return b.fixed&&"right"!==b.fixed?'{{# if(item2.fixed && item2.fixed !== "right"){ }}':"right"===b.fixed?'{{# if(item2.fixed === "right"){ }}':""}(),"{{# var isSort = !(item2.colGroup) && item2.sort; }}",'<th data-field="{{ item2.field||i2 }}" data-key="{{d.index}}-{{i1}}-{{i2}}" {{# if( item2.parentKey){ }}data-parentkey="{{ item2.parentKey }}"{{# } }} {{# if(item2.minWidth){ }}data-minwidth="{{item2.minWidth}}"{{# } }} '+a+' {{# if(item2.unresize || item2.colGroup){ }}data-unresize="true"{{# } }} class="{{# if(item2.hide){ }}layui-hide{{# } }}{{# if(isSort){ }} layui-unselect{{# } }}{{# if(!item2.field){ }} layui-table-col-special{{# } }}">','<div class="layui-table-cell laytable-cell-',"{{# if(item2.colGroup){ }}","group","{{# } else { }}","{{d.index}}-{{i1}}-{{i2}}",'{{# if(item2.type !== "normal"){ }}'," laytable-cell-{{ item2.type }}","{{# } }}","{{# } }}",'" {{#if(item2.align){}}align="{{item2.align}}"{{#}}}>','{{# if(item2.type === "checkbox"){ }}','<input type="checkbox" name="layTableCheckbox" lay-skin="primary" lay-filter="layTableAllChoose" {{# if(item2[d.data.checkName]){ }}checked{{# }; }}>',"{{# } else { }}",'<span>{{item2.title||""}}</span>',"{{# if(isSort){ }}",'<span class="layui-table-sort layui-inline"><i class="layui-edge layui-table-sort-asc" title="升序"></i><i class="layui-edge layui-table-sort-desc" title="降序"></i></span>',"{{# } }}","{{# } }}","</div>","</th>",b.fixed?"{{# }; }}":"","{{# }); }}","</tr>","{{# }); }}","</thead>","</table>"].join("")},V=['<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>',"<tbody></tbody>","</table>"].join(""),M=['<div class="layui-form layui-border-box {{d.VIEW_CLASS}}" lay-filter="LAY-table-{{d.index}}" lay-id="{{ d.data.id }}" style="{{# if(d.data.width){ }}width:{{d.data.width}}px;{{# } }} {{# if(d.data.height){ }}height:{{d.data.height}}px;{{# } }}">',"{{# if(d.data.toolbar){ }}",'<div class="layui-table-tool">','<div class="layui-table-tool-temp"></div>','<div class="layui-table-tool-self"></div>',"</div>","{{# } }}",'<div class="layui-table-box">',"{{# if(d.data.loading){ }}",'<div class="layui-table-init" style="background-color: #fff;">','<i class="layui-icon layui-icon-loading layui-anim layui-anim-rotate layui-anim-loop"></i>',"</div>","{{# } }}","{{# var left, right; }}",'<div class="layui-table-header">',P(),"</div>",'<div class="layui-table-body layui-table-main">',V,"</div>","{{# if(left){ }}",'<div class="layui-table-fixed layui-table-fixed-l">','<div class="layui-table-header">',P({fixed:!0}),"</div>",'<div class="layui-table-body">',V,"</div>","</div>","{{# }; }}","{{# if(right){ }}",'<div class="layui-table-fixed layui-table-fixed-r">','<div class="layui-table-header">',P({fixed:"right"}),'<div class="layui-table-mend"></div>',"</div>",'<div class="layui-table-body">',V,"</div>","</div>","{{# }; }}","</div>","{{# if(d.data.totalRow){ }}",'<div class="layui-table-total">','<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>','<tbody><tr><td><div class="layui-table-cell" style="visibility: hidden;">Total</div></td></tr></tbody>',"</table>","</div>","{{# } }}","{{# if(d.data.page){ }}",'<div class="layui-table-page">','<div id="layui-table-page{{d.index}}"></div>',"</div>","{{# } }}","<style>","{{# layui.each(d.data.cols, function(i1, item1){","layui.each(item1, function(i2, item2){ }}",".laytable-cell-{{d.index}}-{{i1}}-{{i2}}{ ","{{# if(item2.width){ }}","width: {{item2.width}}px;","{{# } }}"," }","{{# });","}); }}","</style>","</div>"].join(""),D=ac(window),O=ac(document),K=function(b){var a=this;a.index=++aq.index,a.config=ac.extend({},a.config,aq.config,b),a.render()};K.prototype.config={limit:10,loading:!0,cellMinWidth:60,defaultToolbar:["filter","exports","print"],autoSort:!0,text:{none:"无数据"}},K.prototype.render=function(){var f=this,c=f.config;if(c.elem=ac(c.elem),c.where=c.where||{},c.id=c.id||c.elem.attr("id")||f.index,c.request=ac.extend({pageName:"page",limitName:"limit"},c.request),c.response=ac.extend({statusName:"code",statusCode:0,msgName:"msg",dataName:"data",countName:"count"},c.response),"object"==typeof c.page&&(c.limit=c.page.limit||c.limit,c.limits=c.page.limits||c.limits,f.page=c.page.curr=c.page.curr||1,delete c.page.elem,delete c.page.jump),!c.elem[0]){return f}c.height&&/^full-\d+$/.test(c.height)&&(f.fullHeightGap=c.height.split("-")[1],c.height=D.height()-f.fullHeightGap),f.setInit();var b=c.elem,h=b.next("."+aa),g=f.elem=ac(al(M).render({VIEW_CLASS:aa,data:c,index:f.index}));if(c.index=f.index,f.key=c.id||c.index,h[0]&&h.remove(),b.after(g),f.layTool=g.find(ai),f.layBox=g.find(an),f.layHeader=g.find(Y),f.layMain=g.find(Q),f.layBody=g.find(ak),f.layFixed=g.find(Z),f.layFixLeft=g.find(q),f.layFixRight=g.find(U),f.layTotal=g.find(J),f.layPage=g.find(G),f.renderToolbar(),f.fullSize(),c.cols.length>1){var d=f.layFixed.find(Y).find("th");d.height(f.layHeader.height()-1-parseFloat(d.css("padding-top"))-parseFloat(d.css("padding-bottom")))}f.pullData(f.page),f.events()},K.prototype.initOpts=function(c){var b=this,a=(b.config,{checkbox:48,radio:48,space:15,numbers:40});c.checkbox&&(c.type="checkbox"),c.space&&(c.type="space"),c.type||(c.type="normal"),"normal"!==c.type&&(c.unresize=!0,c.width=c.width||a[c.type])},K.prototype.setInit=function(c){var b=this,a=b.config;return a.clientWidth=a.width||function(){var d=function(g){var f,e;g=g||a.elem.parent(),f=g.width();try{e="none"===g.css("display")}catch(h){}return !g[0]||f&&!e?f:d(g.parent())};return d()}(),"width"===c?a.clientWidth:void layui.each(a.cols,function(f,d){layui.each(d,function(e,h){if(!h){return void d.splice(e,1)}if(h.key=f+"-"+e,h.hide=h.hide||!1,h.colGroup||h.colspan>1){var g=0;layui.each(a.cols[f+1],function(l,k){k.HAS_PARENT||g>1&&g==h.colspan||(k.HAS_PARENT=!0,k.parentKey=f+"-"+e,g+=parseInt(k.colspan>1?k.colspan:1))}),h.colGroup=!0}b.initOpts(h)})})},K.prototype.renderToolbar=function(){var g=this,c=g.config,b=['<div class="layui-inline" lay-event="add"><i class="layui-icon layui-icon-add-1"></i></div>','<div class="layui-inline" lay-event="update"><i class="layui-icon layui-icon-edit"></i></div>','<div class="layui-inline" lay-event="delete"><i class="layui-icon layui-icon-delete"></i></div>'].join(""),k=g.layTool.find(".layui-table-tool-temp");if("default"===c.toolbar){k.html(b)}else{if("string"==typeof c.toolbar){var i=ac(c.toolbar).html()||"";i&&k.html(al(i).render(c))}}var f={filter:{title:"筛选列",layEvent:"LAYTABLE_COLS",icon:"layui-icon-cols"},exports:{title:"导出",layEvent:"LAYTABLE_EXPORT",icon:"layui-icon-export"},print:{title:"打印",layEvent:"LAYTABLE_PRINT",icon:"layui-icon-print"}},h=[];"object"==typeof c.defaultToolbar&&layui.each(c.defaultToolbar,function(l,d){var a=f[d];a&&h.push('<div class="layui-inline" title="'+a.title+'" lay-event="'+a.layEvent+'"><i class="layui-icon '+a.icon+'"></i></div>')}),g.layTool.find(".layui-table-tool-self").html(h.join(""))},K.prototype.setParentCol=function(k,s){var h=this,p=h.config,g=h.layHeader.find('th[data-key="'+p.index+"-"+s+'"]'),f=parseInt(g.attr("colspan"))||0;if(g[0]){var c=s.split("-"),b=p.cols[c[0]][c[1]];k?f--:f++,g.attr("colspan",f),g[f<1?"addClass":"removeClass"](ao),b.colspan=f,b.hide=f<1;var m=g.data("parentkey");m&&h.setParentCol(k,m)}},K.prototype.setColsPatch=function(){var b=this,a=b.config;layui.each(a.cols,function(d,c){layui.each(c,function(f,e){e.hide&&b.setParentCol(e.hide,e.parentKey)})})},K.prototype.setColsWidth=function(){var m=this,y=m.config,k=0,w=0,h=0,g=0,f=m.setInit("width");m.eachCols(function(c,a){a.hide||k++}),f=f-function(){return"line"===y.skin||"nob"===y.skin?2:k+1}()-m.getScrollWidth(m.layMain[0])-1;var b=function(a){layui.each(y.cols,function(c,d){layui.each(d,function(e,n){var o=0,l=n.minWidth||y.cellMinWidth;return n?void (n.colGroup||n.hide||(a?h&&h<l&&(w--,o=l):(o=n.width||0,/\d+%$/.test(o)?(o=Math.floor(parseFloat(o)/100*f),o<l&&(o=l)):o||(n.width=o=0,w++)),n.hide&&(o=0),g+=o)):void d.splice(e,1)})}),f>g&&w&&(h=(f-g)/w)};b(),b(!0),m.autoColNums=w,m.eachCols(function(d,c){var e=c.minWidth||y.cellMinWidth;c.colGroup||c.hide||(0===c.width?m.getCssRule(y.index+"-"+c.key,function(a){a.style.width=Math.floor(h>=e?h:e)+"px"}):/\d+%$/.test(c.width)&&m.getCssRule(y.index+"-"+c.key,function(a){a.style.width=Math.floor(parseFloat(c.width)/100*f)+"px"}))});var p=m.layMain.width()-m.getScrollWidth(m.layMain[0])-m.layMain.children("table").outerWidth();if(m.autoColNums&&p>=-k&&p<=k){var v=function(c){var a;return c=c||m.layHeader.eq(0).find("thead th:last-child"),a=c.data("field"),!a&&c.prev()[0]?v(c.prev()):c},z=v(),x=z.data("key");m.getCssRule(x,function(c){var a=c.style.width||z.outerWidth();c.style.width=parseFloat(a)+p+"px",m.layMain.height()-m.layMain.prop("clientHeight")>0&&(c.style.width=parseFloat(c.style.width)-1+"px")})}m.loading(!0)},K.prototype.resize=function(){var a=this;a.fullSize(),a.setColsWidth(),a.scrollPatch()},K.prototype.reload=function(b){var a=this;b=b||{},delete a.haveInit,b.data&&b.data.constructor===Array&&delete a.config.data,a.config=ac.extend(!0,{},a.config,b),a.render()},K.prototype.errorView=function(f){var d=this,c=d.layMain.find("."+af),b=ac('<div class="'+af+'">'+(f||"Error")+"</div>");c[0]&&(d.layNone.remove(),c.remove()),d.layFixed.addClass(ao),d.layMain.find("tbody").html(""),d.layMain.append(d.layNone=b),aq.cache[d.key]=[]},K.prototype.page=1,K.prototype.pullData=function(m){var k=this,u=k.config,h=u.request,g=u.response,f=function(){"object"==typeof u.initSort&&k.sort(u.initSort.field,u.initSort.type)};if(k.startTime=(new Date).getTime(),u.url){var b={};b[h.pageName]=m,b[h.limitName]=u.limit;var p=ac.extend(b,u.where);u.contentType&&0==u.contentType.indexOf("application/json")&&(p=JSON.stringify(p)),k.loading(),ac.ajax({type:u.method||"get",url:u.url,contentType:u.contentType,data:p,dataType:"json",headers:u.headers||{},success:function(a){"function"==typeof u.parseData&&(a=u.parseData(a)||a),a[g.statusName]!=g.statusCode?(k.renderForm(),k.errorView(a[g.msgName]||'返回的数据不符合规范，正确的成功状态码应为："'+g.statusName+'": '+g.statusCode)):(k.renderData(a,m,a[g.countName]),f(),u.time=(new Date).getTime()-k.startTime+" ms"),k.setColsWidth(),"function"==typeof u.done&&u.done(a,m,a[g.countName])},error:function(c,a){k.errorView("数据接口请求异常："+a),k.renderForm(),k.setColsWidth()}})}else{if(u.data&&u.data.constructor===Array){var t={},v=m*u.limit-u.limit;t[g.dataName]=u.data.concat().splice(v,u.limit),t[g.countName]=u.data.length,k.renderData(t,m,t[g.countName]),f(),k.setColsWidth(),"function"==typeof u.done&&u.done(t,m,t[g.countName])}}},K.prototype.eachCols=function(b){var a=this;return aq.eachCols(null,b,a.config.cols),a},K.prototype.renderData=function(l,d,b,a){var p=this,w=p.config,t=l[w.response.dataName]||[],i=[],u=[],f=[],k=function(){var c;return !a&&p.sortKey?p.sort(p.sortKey.field,p.sortKey.sort,!0):(layui.each(t,function(h,e){var r=[],s=[],n=[],m=h+w.limit*(d-1)+1;0!==e.length&&(a||(e[aq.config.indexName]=h),p.eachCols(function(A,y){var z=y.field||A,x=w.index+"-"+y.key,o=e[z];if(void 0!==o&&null!==o||(o=""),!y.colGroup){var g=['<td data-field="'+z+'" data-key="'+x+'" '+function(){var v=[];return y.edit&&v.push('data-edit="'+y.edit+'"'),y.align&&v.push('align="'+y.align+'"'),y.templet&&v.push('data-content="'+o+'"'),y.toolbar&&v.push('data-off="true"'),y.event&&v.push('lay-event="'+y.event+'"'),y.style&&v.push('style="'+y.style+'"'),y.minWidth&&v.push('data-minwidth="'+y.minWidth+'"'),v.join(" ")}()+' class="'+function(){var v=[];return y.hide&&v.push(ao),y.field||v.push("layui-table-col-special"),v.join(" ")}()+'">','<div class="layui-table-cell laytable-cell-'+function(){return"normal"===y.type?x:x+" laytable-cell-"+y.type}()+'">'+function(){var C=ac.extend(!0,{LAY_INDEX:m},e),v=aq.config.checkName;switch(y.type){case"checkbox":return'<input type="checkbox" name="layTableCheckbox" lay-skin="primary" '+function(){return y[v]?(e[v]=y[v],y[v]?"checked":""):C[v]?"checked":""}()+">";case"radio":return C[v]&&(c=h),'<input type="radio" name="layTableRadio_'+w.index+'" '+(C[v]?"checked":"")+' lay-type="layTableRadio">';case"numbers":return m}return y.toolbar?al(ac(y.toolbar).html()||"").render(C):ab(y,o,C)}(),"</div></td>"].join("");r.push(g),y.fixed&&"right"!==y.fixed&&s.push(g),"right"===y.fixed&&n.push(g)}}),i.push('<tr data-index="'+h+'">'+r.join("")+"</tr>"),u.push('<tr data-index="'+h+'">'+s.join("")+"</tr>"),f.push('<tr data-index="'+h+'">'+n.join("")+"</tr>"))}),p.layBody.scrollTop(0),p.layMain.find("."+af).remove(),p.layMain.find("tbody").html(i.join("")),p.layFixLeft.find("tbody").html(u.join("")),p.layFixRight.find("tbody").html(f.join("")),p.renderForm(),"number"==typeof c&&p.setThisRowChecked(c),p.syncCheckAll(),p.haveInit?p.scrollPatch():setTimeout(function(){p.scrollPatch()},50),p.haveInit=!0,aj.close(p.tipsIndex),w.HAS_SET_COLS_PATCH||p.setColsPatch(),void (w.HAS_SET_COLS_PATCH=!0))};return aq.cache[p.key]=t,p.layPage[0==b||0===t.length&&1==d?"addClass":"removeClass"](ao),a?k():0===t.length?(p.renderForm(),p.errorView(w.text.none)):(p.layFixed.removeClass(ao),k(),p.renderTotal(t),void (w.page&&(w.page=ac.extend({elem:"layui-table-page"+w.index,count:b,limit:w.limit,limits:w.limits||[10,20,30,40,50,60,70,80,90],groups:3,layout:["prev","page","next","skip","count","limit"],prev:'<i class="layui-icon">&#xe603;</i>',next:'<i class="layui-icon">&#xe602;</i>',jump:function(g,c){c||(p.page=g.curr,w.limit=g.limit,p.pullData(g.curr))}},w.page),w.page.count=b,au.render(w.page))))},K.prototype.renderTotal=function(g){var f=this,d=f.config,c={};if(d.totalRow){layui.each(g,function(h,a){0!==a.length&&f.eachCols(function(m,k){var i=k.field||m,o=a[i];k.totalRow&&(c[i]=(c[i]||0)+(parseFloat(o)||0))})});var b=[];f.eachCols(function(h,a){var k=a.field||h,i=['<td data-field="'+k+'" data-key="'+d.index+"-"+a.key+'" '+function(){var l=[];return a.align&&l.push('align="'+a.align+'"'),a.style&&l.push('style="'+a.style+'"'),a.minWidth&&l.push('data-minwidth="'+a.minWidth+'"'),l.join(" ")}()+' class="'+function(){var l=[];return a.hide&&l.push(ao),a.field||l.push("layui-table-col-special"),l.join(" ")}()+'">','<div class="layui-table-cell laytable-cell-'+function(){var l=d.index+"-"+a.key;return"normal"===a.type?l:l+" laytable-cell-"+a.type}()+'">'+function(){var l=a.totalRowText||"";return a.totalRow?parseFloat(c[k]).toFixed(2)||l:l}(),"</div></td>"].join("");b.push(i)}),f.layTotal.find("tbody").html("<tr>"+b.join("")+"</tr>")}},K.prototype.getColElem=function(f,d){var c=this,b=c.config;return f.eq(0).find(".laytable-cell-"+(b.index+"-"+d)+":eq(0)")},K.prototype.renderForm=function(a){ah.render(a,"LAY-table-"+this.index)},K.prototype.setThisRowChecked=function(f){var d=this,c=(d.config,"layui-table-click"),b=d.layBody.find('tr[data-index="'+f+'"]');b.addClass(c).siblings("tr").removeClass(c)},K.prototype.sort=function(y,t,A,o){var g,b,z=this,F={},E=z.config,w=E.elem.attr("lay-filter"),x=aq.cache[z.key];"string"==typeof y&&z.layHeader.find("th").each(function(f,e){var c=ac(this),h=c.data("field");if(h===y){return y=c,g=h,!1}});try{var g=g||y.data("field"),d=y.data("key");if(z.sortKey&&!A&&g===z.sortKey.field&&t===z.sortKey.sort){return}var C=z.layHeader.find("th .laytable-cell-"+d).find(B);z.layHeader.find("th").find(B).removeAttr("lay-sort"),C.attr("lay-sort",t||null),z.layFixed.find("th")}catch(k){return ag.error("Table modules: Did not match to field")}z.sortKey={field:g,sort:t},E.autoSort&&("asc"===t?b=layui.sort(x,g):"desc"===t?b=layui.sort(x,g,!0):(b=layui.sort(x,aq.config.indexName),delete z.sortKey)),F[E.response.dataName]=b||x,z.renderData(F,z.page,z.count,!0),o&&layui.event.call(y,X,"sort("+w+")",{field:g,type:t})},K.prototype.loading=function(d){var c=this,b=c.config;b.loading&&(d?(c.layInit&&c.layInit.remove(),delete c.layInit,c.layBox.find(at).remove()):(c.layInit=ac(['<div class="layui-table-init">','<i class="layui-icon layui-icon-loading layui-anim layui-anim-rotate layui-anim-loop"></i>',"</div>"].join("")),c.layBox.append(c.layInit)))},K.prototype.setCheckData=function(g,f){var d=this,c=d.config,b=aq.cache[d.key];b[g]&&b[g].constructor!==Array&&(b[g][c.checkName]=f)},K.prototype.syncCheckAll=function(){var f=this,d=f.config,c=f.layHeader.find('input[name="layTableCheckbox"]'),b=function(a){return f.eachCols(function(h,g){"checkbox"===g.type&&(g[d.checkName]=a)}),a};c[0]&&(aq.checkStatus(f.key).isAll?(c[0].checked||(c.prop("checked",!0),f.renderForm("checkbox")),b(!0)):(c[0].checked&&(c.prop("checked",!1),f.renderForm("checkbox")),b(!1)))},K.prototype.getCssRule=function(g,f){var d=this,c=d.elem.find("style")[0],b=c.sheet||c.styleSheet||{},h=b.cssRules||b.rules;layui.each(h,function(k,e){if(e.selectorText===".laytable-cell-"+g){return f(e),!0}})},K.prototype.fullSize=function(){var f,d=this,c=d.config,b=c.height;d.fullHeightGap&&(b=D.height()-d.fullHeightGap,b<135&&(b=135),d.elem.css("height",b)),b&&(f=parseFloat(b)-(d.layHeader.outerHeight()||38),c.toolbar&&(f-=d.layTool.outerHeight()||50),c.totalRow&&(f-=d.layTotal.outerHeight()||40),c.page&&(f-=d.layPage.outerHeight()||41),d.layMain.css("height",f-2))},K.prototype.getScrollWidth=function(b){var a=0;return b?a=b.offsetWidth-b.clientWidth:(b=document.createElement("div"),b.style.width="100px",b.style.height="100px",b.style.overflowY="scroll",document.body.appendChild(b),a=b.offsetWidth-b.clientWidth,document.body.removeChild(b)),a},K.prototype.scrollPatch=function(){var h=this,f=h.layMain.children("table"),c=h.layMain.width()-h.layMain.prop("clientWidth"),b=h.layMain.height()-h.layMain.prop("clientHeight"),p=(h.getScrollWidth(h.layMain[0]),f.outerWidth()-h.layMain.width()),m=function(d){if(c&&b){if(d=d.eq(0),!d.find(".layui-table-patch")[0]){var a=ac('<th class="layui-table-patch"><div class="layui-table-cell"></div></th>');a.find("div").css({width:c}),d.find("tr").append(a)}}else{d.find(".layui-table-patch").remove()}};m(h.layHeader),m(h.layTotal);var g=h.layMain.height(),k=g-b;h.layFixed.find(ak).css("height",f.height()>=k?k:"auto"),h.layFixRight[p>0?"removeClass":"addClass"](ao),h.layFixRight.css("right",c-1)},K.prototype.events=function(){var n,w=this,f=w.config,r=ac("body"),z={},y=w.layHeader.find("th"),k=".layui-table-cell",d=f.elem.attr("lay-filter");w.layTool.on("click","*[lay-event]",function(p){var g=ac(this),A=g.attr("lay-event"),o=function(h){var c=ac(h.list),s=ac('<ul class="layui-table-tool-panel"></ul>');s.html(c),f.height&&s.css("max-height",f.height-(w.layTool.outerHeight()||50)),g.find(".layui-table-tool-panel")[0]||g.append(s),w.renderForm(),s.on("click",function(u){layui.stope(u)}),h.done&&h.done(s,c)};switch(layui.stope(p),O.trigger("table.tool.panel.remove"),aj.close(w.tipsIndex),A){case"LAYTABLE_COLS":o({list:function(){var c=[];return w.eachCols(function(h,e){e.field&&"normal"==e.type&&c.push('<li><input type="checkbox" name="'+e.field+'" data-key="'+e.key+'" data-parentkey="'+(e.parentKey||"")+'" lay-skin="primary" '+(e.hide?"":"checked")+' title="'+(e.title||e.field)+'" lay-filter="LAY_TABLE_TOOL_COLS"></li>')}),c.join("")}(),done:function(){ah.on("checkbox(LAY_TABLE_TOOL_COLS)",function(u){var h=ac(u.elem),c=this.checked,v=h.data("key"),s=h.data("parentkey");layui.each(f.cols,function(E,C){layui.each(C,function(F,e){if(E+"-"+F===v){var H=e.hide;e.hide=!c,w.elem.find('*[data-key="'+f.index+"-"+v+'"]')[c?"removeClass":"addClass"](ao),H!=e.hide&&w.setParentCol(!c,s),w.resize()}})})})}});break;case"LAYTABLE_EXPORT":ae.ie?aj.tips("导出功能不支持 IE，请用 Chrome 等高级浏览器导出",this,{tips:3}):o({list:function(){return['<li data-type="csv">导出到 Csv 文件</li>','<li data-type="xls">导出到 Excel 文件</li>'].join("")}(),done:function(h,c){c.on("click",function(){var s=ac(this).data("type");aq.exportFile(f.id,null,s)})}});break;case"LAYTABLE_PRINT":var b=window.open("打印窗口","_blank"),m=["<style>","body{font-size: 12px; color: #666;}","table{width: 100%; border-collapse: collapse; border-spacing: 0;}","th,td{line-height: 20px; padding: 9px 15px; border: 1px solid #ccc; text-align: left; font-size: 12px; color: #666;}","a{color: #666; text-decoration:none;}","*.layui-hide{display: none}","</style>"].join(""),a=ac(w.layHeader.html());a.append(w.layMain.find("table").html()),a.append(w.layTotal.find("table").html()),a.find("th.layui-table-patch").remove(),a.find(".layui-table-col-special").remove(),b.document.write(m+a.prop("outerHTML")),b.document.close(),b.print(),b.close()}layui.event.call(this,X,"toolbar("+d+")",ac.extend({event:A,config:f},{}))}),y.on("mousemove",function(h){var g=ac(this),c=g.offset().left,b=h.clientX-c;g.data("unresize")||z.resizeStart||(z.allowResize=g.width()-b<=10,r.css("cursor",z.allowResize?"col-resize":""))}).on("mouseleave",function(){ac(this);z.resizeStart||r.css("cursor","")}).on("mousedown",function(c){var b=ac(this);if(z.allowResize){var a=b.data("key");c.preventDefault(),z.resizeStart=!0,z.offset=[c.clientX,c.clientY],w.getCssRule(a,function(h){var g=h.style.width||b.outerWidth();z.rule=h,z.ruleWidth=parseFloat(g),z.minWidth=b.data("minwidth")||f.cellMinWidth})}}),O.on("mousemove",function(b){if(z.resizeStart){if(b.preventDefault(),z.rule){var a=z.ruleWidth+b.clientX-z.offset[0];a<z.minWidth&&(a=z.minWidth),z.rule.style.width=a+"px",aj.close(w.tipsIndex)}n=1}}).on("mouseup",function(a){z.resizeStart&&(z={},r.css("cursor",""),w.scrollPatch()),2===n&&(n=null)}),y.on("click",function(b){var a,g=ac(this),e=g.find(B),c=e.attr("lay-sort");return e[0]&&1!==n?(a="asc"===c?"desc":"desc"===c?null:"asc",void w.sort(g,a,null,!0)):n=2}).find(B+" .layui-edge ").on("click",function(c){var b=ac(this),a=b.index(),g=b.parents("th").eq(0).data("field");layui.stope(c),0===a?w.sort(g,"asc",null,!0):w.sort(g,"desc",null,!0)});var x=function(c){var a=ac(this),h=a.parents("tr").eq(0).data("index"),g=w.layBody.find('tr[data-index="'+h+'"]'),b=aq.cache[w.key]||[];return b=b[h]||{},ac.extend({tr:g,data:aq.clearCacheKey(b),del:function(){aq.cache[w.key][h]=[],g.remove(),w.scrollPatch()},update:function(m){m=m||{},layui.each(m,function(p,o){if(p in b){var u,s=g.children('td[data-field="'+p+'"]');b[p]=o,w.eachCols(function(v,e){e.field==p&&e.templet&&(u=e.templet)}),s.children(k).html(function(){return u?function(){return"function"==typeof u?u(b):al(ac(u).html()||o).render(b)}():o}()),s.data("content",o)}})}},c)};w.elem.on("click",'input[name="layTableCheckbox"]+',function(){var c=ac(this).prev(),b=w.layBody.find('input[name="layTableCheckbox"]'),a=c.parents("tr").eq(0).data("index"),h=c[0].checked,g="layTableAllChoose"===c.attr("lay-filter");g?(b.each(function(o,m){m.checked=h,w.setCheckData(o,h)}),w.syncCheckAll(),w.renderForm("checkbox")):(w.setCheckData(a,h),w.syncCheckAll()),layui.event.call(c[0],X,"checkbox("+d+")",x.call(c[0],{checked:h,type:g?"all":"one"}))}),w.elem.on("click",'input[lay-type="layTableRadio"]+',function(){var c=ac(this).prev(),b=c[0].checked,a=aq.cache[w.key],g=c.parents("tr").eq(0).data("index");layui.each(a,function(m,h){g===m?h.LAY_CHECKED=!0:delete h.LAY_CHECKED}),w.setThisRowChecked(g),layui.event.call(this,X,"radio("+d+")",x.call(this,{checked:b}))}),w.layBody.on("mouseenter","tr",function(){var b=ac(this),a=b.index();b.data("off")||w.layBody.find("tr:eq("+a+")").addClass(av)}).on("mouseleave","tr",function(){var b=ac(this),a=b.index();b.data("off")||w.layBody.find("tr:eq("+a+")").removeClass(av)}).on("click","tr",function(){i.call(this,"row")}).on("dblclick","tr",function(){i.call(this,"rowDouble")});var i=function(b){var a=ac(this);a.data("off")||layui.event.call(this,X,b+"("+d+")",x.call(a.children("td")[0]))};w.layBody.on("change","."+j,function(){var c=ac(this),b=this.value,a=c.parent().data("field"),h=c.parents("tr").eq(0).data("index"),g=aq.cache[w.key][h];g[a]=b,layui.event.call(this,X,"edit("+d+")",x.call(this,{value:b,field:a}))}).on("blur","."+j,function(){var g,a=ac(this),p=this,h=a.parent().data("field"),b=a.parents("tr").eq(0).data("index"),m=aq.cache[w.key][b];w.eachCols(function(e,c){c.field==h&&c.templet&&(g=c.templet)}),a.siblings(k).html(function(c){return g?function(){return"function"==typeof g?g(m):al(ac(g).html()||p.value).render(m)}():c}(p.value)),a.parent().data("content",p.value),a.remove()}),w.layBody.on("click","td",function(h){var g=ac(this),c=(g.data("field"),g.data("edit")),b=g.children(k);if(!g.data("off")&&c){var m=ac('<input class="layui-input '+j+'">');return m[0].value=g.data("content")||b.text(),g.find("."+j)[0]||g.append(m),m.focus(),void layui.stope(h)}}).on("mouseenter","td",function(){t.call(this)}).on("mouseleave","td",function(){t.call(this,"hide")});var l="layui-table-grid-down",t=function(g){var c=ac(this),b=c.children(k);if(!c.data("off")){if(g){c.find(".layui-table-grid-down").remove()}else{if(b.prop("scrollWidth")>b.outerWidth()){if(b.find("."+l)[0]){return}c.append('<div class="'+l+'"><i class="layui-icon layui-icon-down"></i></div>')}}}};w.layBody.on("click","."+l,function(b){var a=ac(this),g=a.parent(),c=g.children(k);w.tipsIndex=aj.tips(['<div class="layui-table-tips-main" style="margin-top: -'+(c.height()+16)+"px;"+function(){return"sm"===f.size?"padding: 4px 15px; font-size: 12px;":"lg"===f.size?"padding: 14px 15px;":""}()+'">',c.html(),"</div>",'<i class="layui-icon layui-table-tips-c layui-icon-close"></i>'].join(""),c[0],{tips:[3,""],time:-1,anim:-1,maxWidth:ae.ios||ae.android?300:w.elem.width()/2,isOutAnim:!1,skin:"layui-table-tips",success:function(m,h){m.find(".layui-table-tips-c").on("click",function(){aj.close(h)})}}),layui.stope(b)}),w.layBody.on("click","*[lay-event]",function(){var b=ac(this),a=b.parents("tr").eq(0).data("index");layui.event.call(this,X,"tool("+d+")",x.call(this,{event:b.attr("lay-event")})),w.setThisRowChecked(a)}),w.layMain.on("scroll",function(){var b=ac(this),a=b.scrollLeft(),c=b.scrollTop();w.layHeader.scrollLeft(a),w.layTotal.scrollLeft(a),w.layFixed.find(ak).scrollTop(c),aj.close(w.tipsIndex)}),O.on("click",function(){O.trigger("table.remove.tool.panel")}),O.on("table.remove.tool.panel",function(){ac(".layui-table-tool-panel").remove()}),D.on("resize",function(){w.resize()})},aq.init=function(f,d){d=d||{};var c=this,b=ac(f?'table[lay-filter="'+f+'"]':am+"[lay-data]"),g="Table element property lay-data configuration item has a syntax error: ";return b.each(function(){var h=ac(this),e=h.attr("lay-data");try{e=new Function("return "+e)()}catch(k){ag.error(g+e)}var m=[],i=ac.extend({elem:this,cols:[],data:[],skin:h.attr("lay-skin"),size:h.attr("lay-size"),even:"string"==typeof h.attr("lay-even")},aq.config,d,e);f&&h.hide(),h.find("thead>tr").each(function(a){i.cols[a]=[],ac(this).children().each(function(p){var o=ac(this),n=o.attr("lay-data");try{n=new Function("return "+n)()}catch(s){return ag.error(g+n)}var t=ac.extend({title:o.text(),colspan:o.attr("colspan")||0,rowspan:o.attr("rowspan")||0},n);t.colspan<2&&m.push(t),i.cols[a].push(t)})}),h.find("tbody>tr").each(function(o){var n=ac(this),l={};n.children("td").each(function(r,p){var a=ac(this),s=a.data("field");if(s){return l[s]=a.html()}}),layui.each(m,function(r,p){var a=n.children("td").eq(r);l[p.field]=a.html()}),i.data[o]=l}),aq.render(i)}),c},ar.that={},ar.config={},aq.eachCols=function(g,d,c){var b=ar.config[g]||{},k=[],h=0;c=ac.extend(!0,[],c||b.cols),layui.each(c,function(i,a){layui.each(a,function(n,m){if(m.colGroup){var e=0;h++,m.CHILD_COLS=[],layui.each(c[i+1],function(o,l){l.PARENT_COL_INDEX||e>1&&e==m.colspan||(l.PARENT_COL_INDEX=h,m.CHILD_COLS.push(l),e+=parseInt(l.colspan>1?l.colspan:1))})}m.PARENT_COL_INDEX||k.push(m)})});var f=function(a){layui.each(a||k,function(l,i){return i.CHILD_COLS?f(i.CHILD_COLS):void ("function"==typeof d&&d(l,i))})};f()},aq.checkStatus=function(g){var f=0,d=0,c=[],b=aq.cache[g]||[];return layui.each(b,function(h,a){return a.constructor===Array?void d++:void (a[aq.config.checkName]&&(f++,c.push(aq.clearCacheKey(a))))}),{data:c,isAll:!!b.length&&f===b.length-d}},aq.exportFile=function(g,f,d){f=f||aq.clearCacheKey(aq.cache[g]),d=d||"csv";var c=ar.config[g]||{},b={csv:"text/csv",xls:"application/vnd.ms-excel"}[d],h=document.createElement("a");return ae.ie?ag.error("IE_NOT_SUPPORT_EXPORTS"):(h.href="data:"+b+";charset=utf-8,\ufeff"+encodeURIComponent(function(){var k=[],e=[];return layui.each(f,function(i,a){var m=[];"object"==typeof g?(layui.each(g,function(n,l){0==i&&k.push(l||"")}),layui.each(aq.clearCacheKey(a),function(n,l){m.push('"'+(l||"")+'"')})):aq.eachCols(g,function(n,l){l.field&&"normal"==l.type&&!l.hide&&(0==i&&k.push(l.title||""),m.push('"'+ab(l,a[l.field],a,"text")+'"'))}),e.push(m.join(","))}),k.join(",")+"\r\n"+e.join("\r\n")}()),h.download=(c.title||"table_"+(c.index||""))+"."+d,document.body.appendChild(h),h.click(),void document.body.removeChild(h))},aq.resize=function(b){if(b){var a=ad(b);if(!a){return}ar.that[b].resize()}else{layui.each(ar.that,function(){this.resize()})}},aq.reload=function(f,d){var c=ad(f);if(c){var b=ar.that[f];return b.reload(d),ar.call(b)}},aq.render=function(b){var a=new K(b);return ar.call(a)},aq.clearCacheKey=function(a){return a=ac.extend({},a),delete a[aq.config.checkName],delete a[aq.config.indexName],a},aq.init(),ap(X,aq)});