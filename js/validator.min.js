var Validator=window.Validator||{ErrorItems:[],ErrorMessage:[],DataType:{Require:/.+/,Email:/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,Phone:/^((\(\d{3}\))|(\d{3}\-))?(\(0\d{2,3}\)|0\d{2,3}-)?[1-9]\d{6,7}$/,Mobile:/^((\+86)|(86))?(13|14|15|18|17)\d{9}$/,Tel:/(^((\+86)|(86))?(13|14|15|18)\d{9}$)|(^((\(\d{3}\))|(\d{3}\-))?(\(0\d{2,3}\)|0\d{2,3}-)?[1-9]\d{6,7}$)/,Url:/^(http|https):\/\/[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^<>\"\"])*$/,IdCard:/^\d{15}(\d{2}[A-Za-z0-9])?$/,Currency:/^\d+(\.\d+)?$/,Zip:/^[1-9]\d{6}$/,QQ:/^[1-9]\d{4,12}$/,Number:/^\d+$/,Integer:/^[-\+]?\d+$/,Double:/^[-\+]?\d+(\.\d+)?$/,English:/^[A-Za-z]+$/,Chinese:/^[\u0391-\uFFE5]+$/,Safe:/^(?:\w*\s*)+$/,Date:/^(?:19|20)[0-9][0-9]-(?:(?:0{0,1}[1-9])|(?:1[0-2]))-(?:(?:[0-2]{0,1}[1-9])|(?:[1-3][0-1]))$/,DateTime:/^(?:19|20)[0-9][0-9]-(?:(?:0{0,1}[1-9])|(?:1[0-2]))-(?:(?:[0-2]{0,1}[1-9])|(?:[1-3][0-1])) (?:(?:[0-2][0-3])|(?:[0-1]{0,1}[0-9])):[0-5]{0,1}[0-9]{1}:[0-5]{0,1}[0-9]{1}$/,Regex:function(e,t){return Validator.ValidFns.Exec(t,e.getAttribute("regexp"))},IsDate:function(e,t){return Validator.RegularMsg.IsDate="值不是合法的日期格式",!isNaN(new Date(t).getTime())},Limit:function(e,t){var r=["字符数"],a=t.length,n=Number(e.getAttribute("min")),l=Number(e.getAttribute("max"));if(n>0&&a<n&&r.push("不能小于["+n+"]个"),l>0&&a>l&&(2==r.length&&r.push("也"),r.push("不能大于["+l+"]个")),r.length>1)return Validator.RegularMsg.Limit=r.join(),!1},LimitB:function(e,t){var r=["字节数"],a=Validator.ValidFns.LenB(t),n=Number(e.getAttribute("min")),l=Number(e.getAttribute("max"));if(n>0&&a<n&&r.push("不能小于["+n+"]个"),l>0&&a>l&&(2==r.length&&r.push("也"),r.push("不能大于["+l+"]个")),r.length>1)return Validator.RegularMsg.LimitB=r.join(),!1},Range:function(e,t){var r=e.getAttribute("min"),a=e.getAttribute("max");return r&&a?(Validator.RegularMsg.Range="值必须在"+r+" ~ "+a+"之间",Number(r)<=Number(t)&&Number(a)>=Number(t)):r?(Validator.RegularMsg.Range="值必须大于等于"+r,Number(r)<=Number(t)):a?(Validator.RegularMsg.Range="值必须小于等于"+a,Number(a)>=Number(t)):void 0},Repeat:function(e,t){var r=e.getAttribute("to");if(!r)throw"the attr of [to] cannot be null, if dataType is: Repeat.";var a=document.getElementById(r)||document.getElementsByName(r)[0];return Validator.RegularMsg.Repeat="值与"+(a.getAttribute("label")||"目标")+"不一致",t==a.value},Equal:function(e,t){var r=e.getAttribute("to");if(!r)throw"the attr of [to] cannot be null, if dataType is: Equal.";var a=document.getElementById(r)||document.getElementsByName(r)[0];return Validator.RegularMsg.Equal="值必须等于"+(a.getAttribute("label")?a.getAttribute("label")+"的":"值：")+a.value,t==a.value},NotEqual:function(e,t){var r=e.getAttribute("to");if(!r)throw"the attr of [to] cannot be null, if dataType is: NotEqual.";var a=document.getElementById(r)||document.getElementsByName(r)[0];return Validator.RegularMsg.NotEqual="值不能等于"+(a.getAttribute("label")?a.getAttribute("label")+"的":"值：")+a.value,t!=a.value},GreaterThan:function(e,t){return Validator.ValidFns.compareTo(t,e.getAttribute("to"),"GreaterThan")},GreaterEqualThan:function(e,t){return Validator.ValidFns.compareTo(t,e.getAttribute("to"),"GreaterEqualThan")},LessThan:function(e,t){return Validator.ValidFns.compareTo(t,e.getAttribute("to"),"LessThan")},LessEqualThan:function(e,t){return Validator.ValidFns.compareTo(t,e.getAttribute("to"),"LessEqualThan")},CompareTime:function(e,t){var r=e.getAttribute("to");if(!r)throw"the attr of [to] cannot be null, if dataType is: Repeat.";var a=document.getElementById(r)||document.getElementsByName(r)[0],n=a.value;if(n)return Validator.RegularMsg.CompareTime="值必须在时间"+n+"之后","string"==typeof t&&(t=new Date(t)),"string"==typeof n&&(n=new Date(n)),t.getTime()>=n.getTime()},Group:function(e,t){var r=["选中的值必须"],a=t.split(",").length,n=Number(e.getAttribute("min")),l=Number(e.getAttribute("max"));if(n>0&&a<n&&r.push("大于"+n+"个"),l>0&&a>l&&(2==r.length&&r.push("并且"),r.push("小于"+l+"个")),r.length>1)return Validator.RegularMsg.Group=r.join(),!1},Corn:function(e,t){return Validator.ValidFns.isCronExpress(Validator.trim(t))},Customer:function(e,t){var r=e.getAttribute("validFN");r?window[r](e,t):console.warn("can not found the value of attr 'validFN' which dataType is: Customer.")}},RegularMsg:{Require:"值不能为空",Email:"值不是合法的Email格式",Phone:"值不是合法的电话号码的格式",Mobile:"值不是合法的手机号码格式",Tel:"值不是合法的电话号码的格式",Url:"值不是合法的Url格式",IdCard:"值不是合法的身份证格式",Currency:"值不是合法的货币格式",Zip:"值不是合法的邮编格式",QQ:"值不是合法的QQ号码格式",Number:"值不是有效数字",Integer:"值不是整数",Double:"值不是数值",English:"值不全为字母",Chinese:"值不全为汉字",Safe:"值不是合法的格式",DateTime:"值不是合法的日期格式",Cron:"corn表达式不正确",Error:"值校验不通过"},ValidFns:{LenB:function(e){return e.replace(/[^\x00-\xff]/g,"**").length},compareTo:function(e,t,r){if(isNaN(e))return Validator.RegularMsg[r]="值不是有效的数字",!1;if(r=r||"compareTo",!t)throw"the attr of [to] cannot be null, if dataType is: "+r+".";var a=document.getElementById(t)||document.getElementsByName(t)[0];return isNaN(a.value)?(Validator.RegularMsg[r]="目标的值不是有效的数字",!1):"GreaterThan"==r?(Validator.RegularMsg[r]="值必须大于"+a.value,Number(e)>Number(a.value)):"GreaterEqualThan"==r?(Validator.RegularMsg[r]="值必须大于等于"+a.value,Number(e)>=Number(a.value)):"LessThan"==r?(Validator.RegularMsg[r]="值必须小于"+a.value,Number(e)<Number(a.value)):"LessEqualThan"==r?(Validator.RegularMsg[r]="值必须小于等于"+a.value,Number(e)<=Number(a.value)):(Validator.RegularMsg[r]="值必须等于"+a.value,Number(e)==Number(a.value))},Exec:function(e,t){return new RegExp(t,"g").test(e)},isCronExpress:function(e){function t(e,t,r){if(!(e.indexOf("-")>-1))return e.indexOf(",")>-1?a(e,t,r):e.indexOf("/")>-1?n(e,t,r):-1!=e.indexOf("*")||l(e,t,r);var i=e.substring(0,e.indexOf("-")),o=e.substring(e.indexOf("-")+1);if(!l(i,t,r,!0)||!l(o,t,r,!0))return!1;try{var u=parseInt(i,10),s=parseInt(o,10);return s>u}catch(e){return!1}}function r(e,t,r,a,n,i){var o=!1,u=!1,s=!1,d=!1,c=!1;"L"==t&&(o=!0,u=!0,s=!1,d=!1,c=!1),"W"!=t&&"C"!=t||(o=!1,u=!0,s=!1,d=!0,c=!1),"#"==t&&(o=!1,u=!0,s=!0,d=!0,c=!0);var g="",f="";if(e.indexOf(t)>=0&&(g=e.substring(0,e.indexOf(t))),e.endsWith(t)||(f=e.substring(e.indexOf(t)+1)),e.indexOf(t)>=0){if(t==e)return o;if(u){if(d&&0==g.length)return!1;if(!l(g,r,a,!0))return!1}else if(g.length>0)return!1;if(s){if(c&&0==f.length)return!1;if(!l(f,n,i,!0))return!1}else if(f.length>0)return!1}return!0}function a(e,t,r){for(var a=e.split(","),n=new Array(a.length),i=0;i<a.length;i++)n[i]=a[i];for(var o=-1,u=0;u<n.length;u++){var s=n[u];if(!l(s,t,r,!0))return!1;try{var d=parseInt(s,10);if(d<=o)return!1;o=d}catch(e){}}return!0}function n(e,t,r){var a=e.substring(0,e.indexOf("/")),n=e.substring(e.indexOf("/")+1);return"*"!=a?l(a,t,r,!0)&&l(n,t,r,!1):l(n,t,r,!0)}function l(e,t,r,a){try{var n=parseInt(e,10);return e==n&&(!a||!(n<t||n>r))}catch(e){return!1}}function i(e){return t(e,1970,2099)}function o(e){return e.replace("JAN","1"),e.replace("FEB","2"),e.replace("MAR","3"),e.replace("APR","4"),e.replace("MAY","5"),e.replace("JUN","6"),e.replace("JUL","7"),e.replace("AUG","8"),e.replace("SEP","9"),e.replace("OCT","10"),e.replace("NOV","11"),e.replace("DEC","12"),t(e,1,31)}function u(e){return"?"==e||(e.indexOf("L")>=0?r(e,"L",1,7,-1,-1):e.indexOf("W")>=0?r(e,"W",1,31,-1,-1):e.indexOf("C")>=0?r(e,"C",1,31,-1,-1):t(e,1,31))}function s(e){return e.replace("SUN","1"),e.replace("MON","2"),e.replace("TUE","3"),e.replace("WED","4"),e.replace("THU","5"),e.replace("FRI","6"),e.replace("SAT","7"),"?"==e||(e.indexOf("L")>=0?r(e,"L",1,7,-1,-1):e.indexOf("C")>=0?r(e,"C",1,7,-1,-1):e.indexOf("#")>=0?r(e,"#",1,7,1,5):t(e,1,7))}function d(e){return t(e,0,23)}function c(e){return t(e,0,59)}function g(e){return t(e,0,59)}var f=e.split(" ");return!(f.length<6||f.length>7)&&(("?"==f[3]||"?"==f[5])&&(!!g(f[0])&&(!!c(f[1])&&(!!d(f[2])&&(!!u(f[3])&&(!!o(f[4])&&(!!s(f[5])&&!(7==f.length&&!i(f[6])))))))))}},valid:function(e,t){Validator.ErrorItems=[document.forms[0]],Validator.ErrorMessage=["以下原因导致操作失败：\t\t\t\t"];var r=e||event.srcElement;if(null!=r&&(r instanceof jQuery&&(r=r[0]),"FORM"!=r.tagName.toUpperCase()&&(r=r.form)),null==r||"FORM"!=r.tagName.toUpperCase())return alert("没有定义form对象"),!1;for(var a=[],n=[],l=r.elements.length,i=0;i<l;i++){var o=r.elements[i],u=o.type;if(u){var s=o.getAttribute("name"),d=o.getAttribute("require")||"",c=o.getAttribute("dataType")||"";if("true"==d||""!=c){Validator.ClearState(o);var g=[];if("checkbox"==u||"radio"==u){if(s){if(Validator.ArrayContains(n,s))continue;n.push(s);for(var f=document.getElementsByName(s),m=0;m<f.length;m++)f[m].checked&&g.push(f[m].value)}}else if("select-multiple"==u)for(var v=o,h=0;h<v.options.length;h++)v.options[h].selected&&g.push(v[h].value);else g.push(o.value);a.push({element:o,value:g})}}}for(var p=0;p<a.length;p++){var b=a[p],y=(o=b.element,Validator.validOne(o,b.value));if(null!=y&&1!=y&&""!==y){if(0==y){var E=o.getAttribute("dataType")||"";y=Validator.RegularMsg[E]}y||(y=Validator.RegularMsg.Error),Validator.AddError(o,y)}}return Validator.showError(t)},validOne:function(ele,values){var require=ele.getAttribute("require")||"",dataTypes=ele.getAttribute("dataType")||"",value=values.join();if("true"==require&&""==value)return Validator.RegularMsg.Require;if(!dataTypes)return!0;for(var dataTypeArr=dataTypes.split(";"),i=0;i<dataTypeArr.length;i++){var dt=dataTypeArr[i],validProcess=Validator.DataType[dt];if(""!=dt&&void 0!==validProcess)if("object"==typeof validProcess){if(""==value&&"Require"!=dt)continue;if(!validProcess.test(value))return!1;if("Double"==dt){var scale=ele.getAttribute("scale");if(scale){var theValArr=value.split(".");if(2==theValArr.length&&theValArr[1].length>scale)return"值只能有"+scale+"位有效小数"}}}else if("string"==typeof validProcess){if(""==value)continue;var validProcessFn="(function(validator){with(validator){"+validProcess+"}})(this)";with(ele){var flag=eval(validProcessFn);if(!flag)return RegularMsg[dt]||RegularMsg.Error}}else if("function"==typeof validProcess)return validProcess(ele,value)}},AddError:function(e,t){Validator.ErrorItems[Validator.ErrorItems.length]=e,Validator.ErrorMessage[Validator.ErrorMessage.length]=t||""},showError:function(e){if(Validator.ErrorMessage.length>1){e=e||1;var t=Validator.ErrorItems.length;if(window.jQuery&&window.layer)if(e<2){var r=3;e=e.toString(),e.indexOf(".")>0&&(r=e.substr(e.indexOf(".")+1));for(var a=1;a<t;a++){var n=Validator.ErrorItems[a];"checkbox"!=n.type&&"radio"!=n.type||(n=n.parentNode),layer.tips(Validator.ErrorMessage[a],n,{tips:[r,"#F90"],tipsMore:!0})}}else{for(var l=Validator.ErrorMessage[0]+"<br>",i=1;i<Validator.ErrorMessage.length;i++){n=Validator.ErrorItems[i];l+=i+": "+(n.getAttribute("label")||n.getAttribute("name")||"")+"的"+Validator.ErrorMessage[i]+"<br>"}Mom.top().layer.alert(l,{skin:"2.1"==e?"layui-layer-lan":Const.layerSkin()||"",title:"警告",closeBtn:0,anim:5})}else if(2==e){for(a=1;a<t;a++)try{var o=document.createElement("SPAN");o.id="__ErrorMessagePanel",o.style.color="red",Validator.ErrorItems[a].parentNode.appendChild(o),o.innerHTML=Validator.ErrorMessage[a].replace(/\d+:/,"*")}catch(e){alert(e.description)}Validator.ErrorItems[1].focus()}else if(3==e){var u=Validator.ErrorItems[1];u.style.color="blue";var s=0,d=setInterval(function(){u.style.color=s%2==0?"red":"blue",s++,5==s&&clearInterval(d)},300);Validator.ErrorItems[1].focus()}else{for(l=Validator.ErrorMessage[0]+"<br>",i=1;i<Validator.ErrorMessage.length;i++){n=Validator.ErrorItems[i];l+=i+": "+(n.getAttribute("label")||n.getAttribute("name")||"")+"的"+Validator.ErrorMessage[i]+"<br>"}alert(l);try{Validator.ErrorItems[1].focus()}catch(e){}}return!1}return!0},ArrayContains:function(e,t){return RegExp("(^|,)"+t.toString()+"($|,)").test(e)},ClearState:function(elem){with(elem){"red"==style.color&&(style.color="");var lastNode=parentNode.childNodes[parentNode.childNodes.length-1];"__ErrorMessagePanel"==lastNode.id&&parentNode.removeChild(lastNode)}},dateFormat:function(e,t){"string"==typeof e&&(e=new Date(e));var r={"y+":e.getFullYear().toString(),"M+":(e.getMonth()+1).toString(),"d+":e.getDate().toString(),"H+":e.getHours().toString(),"m+":e.getMinutes().toString(),"s+":e.getSeconds().toString()};for(var a in r){var n=new RegExp("("+a+")").exec(t);n&&(t=t.replace(n[1],1==n[1].length?r[a]:r[a].padStart(n[1].length,"0")))}return t},IdentityCodeValid:function(e){var t="";if(""==e)return t;var r={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江 ",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北 ",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏 ",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外 "};if(e&&/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[012])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(e))if(r[e.substr(0,2)]){if(18==e.length){e=e.split("");for(var a=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],n=[1,0,"X",9,8,7,6,5,4,3,2],l=0,i=0,o=0,u=0;u<17;u++)i=e[u],o=a[u],l+=i*o;n[l%11];n[l%11]!=e[17].toUpperCase()&&(t="校验位错误")}}else t="地址编码错误";else t="身份证号格式错误";return t},checkNull:function(e,t){var r=!1,a=e;if(null!=e&&("string"==typeof e&&(a=document.forms[0][e]),""==a.value.trim())){r=!0,null!=t&&null!=t&&window.alert(t);try{a.focus()}catch(e){}}return r},checkRadiosIsSelected:function(e){var t=!1,r=e;if("string"==typeof e&&(r=document.getElementsByName(e)),null==r||0==r.length)return!0;for(var a=0;a<r.length;a++)if(r[a].checked){t=!0;break}return t},setCheckboxValue:function(e,t){var r=document.getElementsByName(e);if(null!=r&&null!=t){var a=t;a.constructor==String&&(a=String(t).split(","));for(var n=r.length,l=0;l<n;l++)Validator.ArrayContains(a,r[l].value)?$(r[l]).hasClass("i-checks")?$(r[l]).iCheck("check"):r[l].checked=!0:$(r[l]).hasClass("i-checks")?$(r[l]).iCheck("uncheck"):r[l].checked=!1;try{$("input[name='"+e+"']").trigger("change")}catch(e){}}},getDefaultVal:function(e){var t=e.type;if("select-one"!=t)return e.defaultValue;for(var r=e.options,a=r.length-1;a>=0;a--)if(r[a].defaultSelected)return r[a].value},getCheckboxValue:function(e){var t=[],r=document.getElementsByName(e);if(null==r||0==r.length)return"";for(var a=r.length,n=0;n<a;n++)r[n].checked&&t.push(r[n].value);return t.join(",")},getRadiosValue:function(e){var t=document.getElementsByName(e);if(null==t)return"";for(var r=0;r<t.length;r++)if(t[r].checked)return t[r].value;return""},getOptionText:function(e){for(var t="",r=0;r<e.options.length;r++)if(e.options[r].selected&&""!=e.value){t=e.options[r].text;break}return t},allRadiosSelect:function(e,t){for(var r=document.getElementsByName(e),a=0;a<r.length;a++)if(null!=r[a]){r[a].checked=t;try{r[a].fireEvent("onclick")}catch(e){}}},clearOpts:function(e){if(null!=e){for(;e.childNodes.length>0;)e.removeChild(e.childNodes[0]);var t=document.createElement("option");t.appendChild(document.createTextNode("-- 请选择 --")),t.setAttribute("value",""),e.appendChild(t)}},renderData:function(e,t,r){if(e&&null!=e){null==r&&(r=[]);for(var a=Validator.getJsonData(e),n=0;n<a.length;n++){var l=a[n];if(null!=l.value&&""!==l.value&&!($.inArray(l.name,r)>-1)){var i=$(document.getElementById(l.name));if(0==i.length&&(i=$(t).find("*[name = '"+l.name+"']")),i.length>0){var o=i[0].type;o?"radio"==o?Validator.setCheckboxValue(l.name,l.value):"checkbox"==o?Validator.setCheckboxValue(l.name,l.value):("select-one"==o||"select-multiple"==o)&&(Mom.BrowserType(9)||Mom.BrowserType(10))?($(i).val(l.value),i.change()):$(i).val(l.value):$(i).text(l.value)}}}layui&&layui.form&&$(".layui-form").length&&layui.form.render()}},getJsonData:function(e,t,r){for(var a in null==r&&(r=""),null==t&&(t=new Array),e){var n=e[a],l=""==r?a:r+"."+a;n instanceof Array||"object"!=typeof n?t.push({name:l,value:n}):Validator.getJsonData(n,t,l)}return t},trim:function(e){return e.replace(/^\s*|\s*$/g,"")}};